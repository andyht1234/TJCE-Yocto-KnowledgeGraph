* Skipping already-stripped check doesn't work
@ 2022-04-11 16:13 Alessandro Tagliapietra
  2022-04-11 18:14 ` [yocto] " Jose Quaresma
  2022-04-11 18:27 ` Khem Raj
  0 siblings, 2 replies; 14+ messages in thread
From: Alessandro Tagliapietra @ 2022-04-11 16:13 UTC (permalink / raw)
  To: yocto

[-- Attachment #1: Type: text/plain, Size: 3571 bytes --]

I've created an npm package recipe for node-red-node-serialport ( https://www.npmjs.com/package/node-red-node-serialport ) using

devtool add "npm://registry.npmjs.org;package=node-red-node-serialport;version=1.0.1"

which generated this ( https://gist.github.com/alex88/e0e1bca5ac07137229839120f8bfe273 ) recipe.

The problem is when building I get

> 
> WARNING: node-red-node-serialport-1.0.1-r0 do_compile: Use of configs
> argument of NpmEnvironment.run() function is deprecated. Please use args
> argument instead.
> WARNING: node-red-node-serialport-1.0.1-r0 do_compile: Use of configs
> argument of NpmEnvironment.run() function is deprecated. Please use args
> argument instead.
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/android-arm/node.napi.armv7.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/android-arm64/node.napi.armv8.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv6.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm64/node.napi.armv8.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-x64/node.napi.glibc.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-x64/node.napi.musl.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: Fatal QA errors
> found, failing task.
> ERROR: Logfile of failure stored in:
> /home/alex/Projects/yocto/build/tmp/work/cortexa7t2hf-neon-vfpv4-poky-linux-gnueabi/node-red-node-serialport/1.0.1-r0/temp/log.do_package.75444
> 
> ERROR: Task
> (/home/alex/Projects/yocto/meta-things5/recipes-devtools/node-red-node-serialport/node-red-node-serialport_1.0.1.bb:do_package)
> failed with exit code '1'
> 

I've tried to add

INSANE_SKIP_${PN} += "already-stripped"

in the recipe and in a bbappend but I still get the error.

Why? I need to get this out asap so any help is appreciated.

[-- Attachment #2: Type: text/html, Size: 3779 bytes --]

^ permalink raw reply	[flat|nested] 14+ messages in thread
* Re: [yocto] Skipping already-stripped check doesn't work
  2022-04-11 16:13 Skipping already-stripped check doesn't work Alessandro Tagliapietra
@ 2022-04-11 18:14 ` Jose Quaresma
  2022-04-11 18:27 ` Khem Raj
  1 sibling, 0 replies; 14+ messages in thread
From: Jose Quaresma @ 2022-04-11 18:14 UTC (permalink / raw)
  To: Alessandro Tagliapietra; +Cc: Yocto-mailing-list

[-- Attachment #1: Type: text/plain, Size: 4556 bytes --]

Alessandro Tagliapietra <tagliapietra.alessandro@gmail.com> escreveu no dia
segunda, 11/04/2022 à(s) 17:13:

> I've created an npm package recipe for node-red-node-serialport
> <https://www.npmjs.com/package/node-red-node-serialport> using
>
> devtool add "npm://registry.npmjs.org
> ;package=node-red-node-serialport;version=1.0.1"
>
> which generated this
> <https://gist.github.com/alex88/e0e1bca5ac07137229839120f8bfe273> recipe.
>
> The problem is when building I get
>
> WARNING: node-red-node-serialport-1.0.1-r0 do_compile: Use of configs
> argument of NpmEnvironment.run() function is deprecated. Please use args
> argument instead.
> WARNING: node-red-node-serialport-1.0.1-r0 do_compile: Use of configs
> argument of NpmEnvironment.run() function is deprecated. Please use args
> argument instead.
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/android-arm/node.napi.armv7.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/android-arm64/node.napi.armv8.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv6.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm64/node.napi.armv8.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-x64/node.napi.glibc.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-x64/node.napi.musl.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: Fatal QA errors
> found, failing task.
> ERROR: Logfile of failure stored in:
> /home/alex/Projects/yocto/build/tmp/work/cortexa7t2hf-neon-vfpv4-poky-linux-gnueabi/node-red-node-serialport/1.0.1-r0/temp/log.do_package.75444
> ERROR: Task
> (/home/alex/Projects/yocto/meta-things5/recipes-devtools/node-red-node-serialport/node-red-node-serialport_1.0.1.bb:do_package)
> failed with exit code '1'
>
> I've tried to add
>
> INSANE_SKIP_${PN} += "already-stripped"
>
> in the recipe and in a bbappend but I still get the error.
>
> Why? I need to get this out asap so any help is appreciated.
>

Hi Alessandro,

This is because the package that you are building is already compiled and
there seems to be too many archs.
Your target archs is arm (cortexa7t2hf-neon-vfpv4-poky-linux-gnueabi) and
it is pre builded for a bunch of arch (prebuilds/linux-XX, where XX is the
arch).
Yocto can cross compile the code for you and probably you don't need the
pre-built binaries.

Jose


> -=-=-=-=-=-=-=-=-=-=-=-
> Links: You receive all messages sent to this group.
> View/Reply Online (#56718):
> https://lists.yoctoproject.org/g/yocto/message/56718
> Mute This Topic: https://lists.yoctoproject.org/mt/90398675/5052612
> Group Owner: yocto+owner@lists.yoctoproject.org
> Unsubscribe: https://lists.yoctoproject.org/g/yocto/unsub [
> quaresma.jose@gmail.com]
> -=-=-=-=-=-=-=-=-=-=-=-
>
>

-- 
Best regards,

José Quaresma

[-- Attachment #2: Type: text/html, Size: 5961 bytes --]

^ permalink raw reply	[flat|nested] 14+ messages in thread
* Re: [yocto] Skipping already-stripped check doesn't work
  2022-04-11 16:13 Skipping already-stripped check doesn't work Alessandro Tagliapietra
  2022-04-11 18:14 ` [yocto] " Jose Quaresma
@ 2022-04-11 18:27 ` Khem Raj
  2022-04-11 20:27   ` Alessandro Tagliapietra
  1 sibling, 1 reply; 14+ messages in thread
From: Khem Raj @ 2022-04-11 18:27 UTC (permalink / raw)
  To: Alessandro Tagliapietra; +Cc: Yocto-mailing-list

The prebuilds are for other architectures. so perhaps you can rm them
in a do_install_append() or if they are really needed
you perhaps would also need INSANE_SKIP_<name of package> = "arch" eventually

is your recipe called node-red-node-serialport ?
INSANE_SKIP_${PN} is only accounting for one output package. You
perhaps will need to specify it for all the packages generated by this
recipe.
so check where these files are landing in packages-split/ folder in
the build area of this recipe

On Mon, Apr 11, 2022 at 9:13 AM Alessandro Tagliapietra
<tagliapietra.alessandro@gmail.com> wrote:
>
> I've created an npm package recipe for node-red-node-serialport using
>
> devtool add "npm://registry.npmjs.org;package=node-red-node-serialport;version=1.0.1"
>
> which generated this recipe.
>
> The problem is when building I get
>
> WARNING: node-red-node-serialport-1.0.1-r0 do_compile: Use of configs argument of NpmEnvironment.run() function is deprecated. Please use args argument instead.
> WARNING: node-red-node-serialport-1.0.1-r0 do_compile: Use of configs argument of NpmEnvironment.run() function is deprecated. Please use args argument instead.
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/android-arm/node.napi.armv7.node' from node-red-node-serialport was already stripped, this will prevent future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/android-arm64/node.napi.armv8.node' from node-red-node-serialport was already stripped, this will prevent future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv6.node' from node-red-node-serialport was already stripped, this will prevent future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node' from node-red-node-serialport was already stripped, this will prevent future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm64/node.napi.armv8.node' from node-red-node-serialport was already stripped, this will prevent future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-x64/node.napi.glibc.node' from node-red-node-serialport was already stripped, this will prevent future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-x64/node.napi.musl.node' from node-red-node-serialport was already stripped, this will prevent future debugging! [already-stripped]
> ERROR: node-red-node-serialport-1.0.1-r0 do_package: Fatal QA errors found, failing task.
> ERROR: Logfile of failure stored in: /home/alex/Projects/yocto/build/tmp/work/cortexa7t2hf-neon-vfpv4-poky-linux-gnueabi/node-red-node-serialport/1.0.1-r0/temp/log.do_package.75444
> ERROR: Task (/home/alex/Projects/yocto/meta-things5/recipes-devtools/node-red-node-serialport/node-red-node-serialport_1.0.1.bb:do_package) failed with exit code '1'
>
> I've tried to add
>
> INSANE_SKIP_${PN} += "already-stripped"
>
> in the recipe and in a bbappend but I still get the error.
>
> Why? I need to get this out asap so any help is appreciated.
>
> -=-=-=-=-=-=-=-=-=-=-=-
> Links: You receive all messages sent to this group.
> You automatically follow any topics you start or reply to.
> View/Reply Online (#56718): https://lists.yoctoproject.org/g/yocto/message/56718
> Mute This Topic: https://lists.yoctoproject.org/mt/90398675/1997914
> Group Owner: yocto+owner@lists.yoctoproject.org
> Unsubscribe: https://lists.yoctoproject.org/g/yocto/unsub [raj.khem@gmail.com]
> -=-=-=-=-=-=-=-=-=-=-=-
>


^ permalink raw reply	[flat|nested] 14+ messages in thread
* Re: [yocto] Skipping already-stripped check doesn't work
  2022-04-11 18:27 ` Khem Raj
@ 2022-04-11 20:27   ` Alessandro Tagliapietra
  2022-04-11 20:36     ` Khem Raj
       [not found]     ` <14b889eed4e3a424b27120bd7d231ae8fcdce1df.camel@linuxfoundation.org>
  0 siblings, 2 replies; 14+ messages in thread
From: Alessandro Tagliapietra @ 2022-04-11 20:27 UTC (permalink / raw)
  To: Khem Raj; +Cc: Yocto-mailing-list

[-- Attachment #1: Type: text/plain, Size: 5695 bytes --]

Thank you for helping!

The package is node-red-node-serialport, it doesn't seem to create child
packages for the dependencies, the nodejs deps only reside in the package
node-modules folder.
The packages-split only contained node-red-node-serialport-* packages.

So I've tried to add the skips for these child packages too:

INSANE_SKIP_${PN} += "already-stripped arch"
INSANE_SKIP_${PN}-dbg += "already-stripped arch"
INSANE_SKIP_${PN}-dev += "already-stripped arch"
INSANE_SKIP_${PN}-doc += "already-stripped arch"
INSANE_SKIP_${PN}-locale += "already-stripped arch"
INSANE_SKIP_${PN}-src += "already-stripped arch"
INSANE_SKIP_${PN}-staticdev += "already-stripped arch"

and I still get the error.

I've then tried to remove them:

do_install:prepend() {
    rm -Rf
${NPM_BUILD}/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds
}

and it seems to work, however I would like to keep them as the armv7 is the
one that's probably used for the raspberry.
Any other things I can try to ignore the QA check?

Thank you


On Mon, Apr 11, 2022 at 11:27 AM Khem Raj <raj.khem@gmail.com> wrote:

> The prebuilds are for other architectures. so perhaps you can rm them
> in a do_install_append() or if they are really needed
> you perhaps would also need INSANE_SKIP_<name of package> = "arch"
> eventually
>
> is your recipe called node-red-node-serialport ?
> INSANE_SKIP_${PN} is only accounting for one output package. You
> perhaps will need to specify it for all the packages generated by this
> recipe.
> so check where these files are landing in packages-split/ folder in
> the build area of this recipe
>
> On Mon, Apr 11, 2022 at 9:13 AM Alessandro Tagliapietra
> <tagliapietra.alessandro@gmail.com> wrote:
> >
> > I've created an npm package recipe for node-red-node-serialport using
> >
> > devtool add "npm://registry.npmjs.org
> ;package=node-red-node-serialport;version=1.0.1"
> >
> > which generated this recipe.
> >
> > The problem is when building I get
> >
> > WARNING: node-red-node-serialport-1.0.1-r0 do_compile: Use of configs
> argument of NpmEnvironment.run() function is deprecated. Please use args
> argument instead.
> > WARNING: node-red-node-serialport-1.0.1-r0 do_compile: Use of configs
> argument of NpmEnvironment.run() function is deprecated. Please use args
> argument instead.
> > ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/android-arm/node.napi.armv7.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> > ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/android-arm64/node.napi.armv8.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> > ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv6.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> > ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> > ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm64/node.napi.armv8.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> > ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-x64/node.napi.glibc.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> > ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File
> '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-x64/node.napi.musl.node'
> from node-red-node-serialport was already stripped, this will prevent
> future debugging! [already-stripped]
> > ERROR: node-red-node-serialport-1.0.1-r0 do_package: Fatal QA errors
> found, failing task.
> > ERROR: Logfile of failure stored in:
> /home/alex/Projects/yocto/build/tmp/work/cortexa7t2hf-neon-vfpv4-poky-linux-gnueabi/node-red-node-serialport/1.0.1-r0/temp/log.do_package.75444
> > ERROR: Task
> (/home/alex/Projects/yocto/meta-things5/recipes-devtools/node-red-node-serialport/node-red-node-serialport_1.0.1.bb:do_package)
> failed with exit code '1'
> >
> > I've tried to add
> >
> > INSANE_SKIP_${PN} += "already-stripped"
> >
> > in the recipe and in a bbappend but I still get the error.
> >
> > Why? I need to get this out asap so any help is appreciated.
> >
> > -=-=-=-=-=-=-=-=-=-=-=-
> > Links: You receive all messages sent to this group.
> > You automatically follow any topics you start or reply to.
> > View/Reply Online (#56718):
> https://lists.yoctoproject.org/g/yocto/message/56718
> > Mute This Topic: https://lists.yoctoproject.org/mt/90398675/1997914
> > Group Owner: yocto+owner@lists.yoctoproject.org
> > Unsubscribe: https://lists.yoctoproject.org/g/yocto/unsub [
> raj.khem@gmail.com]
> > -=-=-=-=-=-=-=-=-=-=-=-
> >
>

[-- Attachment #2: Type: text/html, Size: 7205 bytes --]

^ permalink raw reply	[flat|nested] 14+ messages in thread
* Re: [yocto] Skipping already-stripped check doesn't work
  2022-04-11 20:27   ` Alessandro Tagliapietra
@ 2022-04-11 20:36     ` Khem Raj
  2022-04-11 20:43       ` Alessandro Tagliapietra
       [not found]     ` <14b889eed4e3a424b27120bd7d231ae8fcdce1df.camel@linuxfoundation.org>
  1 sibling, 1 reply; 14+ messages in thread
From: Khem Raj @ 2022-04-11 20:36 UTC (permalink / raw)
  To: Alessandro Tagliapietra; +Cc: Yocto-mailing-list

On Mon, Apr 11, 2022 at 1:27 PM Alessandro Tagliapietra
<tagliapietra.alessandro@gmail.com> wrote:
>
> Thank you for helping!
>
> The package is node-red-node-serialport, it doesn't seem to create child packages for the dependencies, the nodejs deps only reside in the package node-modules folder.
> The packages-split only contained node-red-node-serialport-* packages.
>

what package folders do you see under packages-split/ folder in your
build area for this recipe ?

> So I've tried to add the skips for these child packages too:
>
> INSANE_SKIP_${PN} += "already-stripped arch"
> INSANE_SKIP_${PN}-dbg += "already-stripped arch"
> INSANE_SKIP_${PN}-dev += "already-stripped arch"
> INSANE_SKIP_${PN}-doc += "already-stripped arch"
> INSANE_SKIP_${PN}-locale += "already-stripped arch"
> INSANE_SKIP_${PN}-src += "already-stripped arch"
> INSANE_SKIP_${PN}-staticdev += "already-stripped arch"
>
> and I still get the error.
>
> I've then tried to remove them:
>
> do_install:prepend() {
>     rm -Rf ${NPM_BUILD}/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds
> }
>
> and it seems to work, however I would like to keep them as the armv7 is the one that's probably used for the raspberry.
> Any other things I can try to ignore the QA check?
>
> Thank you
>
>
> On Mon, Apr 11, 2022 at 11:27 AM Khem Raj <raj.khem@gmail.com> wrote:
>>
>> The prebuilds are for other architectures. so perhaps you can rm them
>> in a do_install_append() or if they are really needed
>> you perhaps would also need INSANE_SKIP_<name of package> = "arch" eventually
>>
>> is your recipe called node-red-node-serialport ?
>> INSANE_SKIP_${PN} is only accounting for one output package. You
>> perhaps will need to specify it for all the packages generated by this
>> recipe.
>> so check where these files are landing in packages-split/ folder in
>> the build area of this recipe
>>
>> On Mon, Apr 11, 2022 at 9:13 AM Alessandro Tagliapietra
>> <tagliapietra.alessandro@gmail.com> wrote:
>> >
>> > I've created an npm package recipe for node-red-node-serialport using
>> >
>> > devtool add "npm://registry.npmjs.org;package=node-red-node-serialport;version=1.0.1"
>> >
>> > which generated this recipe.
>> >
>> > The problem is when building I get
>> >
>> > WARNING: node-red-node-serialport-1.0.1-r0 do_compile: Use of configs argument of NpmEnvironment.run() function is deprecated. Please use args argument instead.
>> > WARNING: node-red-node-serialport-1.0.1-r0 do_compile: Use of configs argument of NpmEnvironment.run() function is deprecated. Please use args argument instead.
>> > ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/android-arm/node.napi.armv7.node' from node-red-node-serialport was already stripped, this will prevent future debugging! [already-stripped]
>> > ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/android-arm64/node.napi.armv8.node' from node-red-node-serialport was already stripped, this will prevent future debugging! [already-stripped]
>> > ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv6.node' from node-red-node-serialport was already stripped, this will prevent future debugging! [already-stripped]
>> > ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node' from node-red-node-serialport was already stripped, this will prevent future debugging! [already-stripped]
>> > ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm64/node.napi.armv8.node' from node-red-node-serialport was already stripped, this will prevent future debugging! [already-stripped]
>> > ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-x64/node.napi.glibc.node' from node-red-node-serialport was already stripped, this will prevent future debugging! [already-stripped]
>> > ERROR: node-red-node-serialport-1.0.1-r0 do_package: QA Issue: File '/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-x64/node.napi.musl.node' from node-red-node-serialport was already stripped, this will prevent future debugging! [already-stripped]
>> > ERROR: node-red-node-serialport-1.0.1-r0 do_package: Fatal QA errors found, failing task.
>> > ERROR: Logfile of failure stored in: /home/alex/Projects/yocto/build/tmp/work/cortexa7t2hf-neon-vfpv4-poky-linux-gnueabi/node-red-node-serialport/1.0.1-r0/temp/log.do_package.75444
>> > ERROR: Task (/home/alex/Projects/yocto/meta-things5/recipes-devtools/node-red-node-serialport/node-red-node-serialport_1.0.1.bb:do_package) failed with exit code '1'
>> >
>> > I've tried to add
>> >
>> > INSANE_SKIP_${PN} += "already-stripped"
>> >
>> > in the recipe and in a bbappend but I still get the error.
>> >
>> > Why? I need to get this out asap so any help is appreciated.
>> >
>> > -=-=-=-=-=-=-=-=-=-=-=-
>> > Links: You receive all messages sent to this group.
>> > You automatically follow any topics you start or reply to.
>> > View/Reply Online (#56718): https://lists.yoctoproject.org/g/yocto/message/56718
>> > Mute This Topic: https://lists.yoctoproject.org/mt/90398675/1997914
>> > Group Owner: yocto+owner@lists.yoctoproject.org
>> > Unsubscribe: https://lists.yoctoproject.org/g/yocto/unsub [raj.khem@gmail.com]
>> > -=-=-=-=-=-=-=-=-=-=-=-
>> >


^ permalink raw reply	[flat|nested] 14+ messages in thread
* Re: [yocto] Skipping already-stripped check doesn't work
  2022-04-11 20:36     ` Khem Raj
@ 2022-04-11 20:43       ` Alessandro Tagliapietra
  2022-04-11 21:14         ` Khem Raj
  0 siblings, 1 reply; 14+ messages in thread
From: Alessandro Tagliapietra @ 2022-04-11 20:43 UTC (permalink / raw)
  To: Khem Raj; +Cc: Yocto-mailing-list

[-- Attachment #1: Type: text/plain, Size: 939 bytes --]

On Mon, Apr 11, 2022 at 1:36 PM Khem Raj <raj.khem@gmail.com> wrote:

>
> what package folders do you see under packages-split/ folder in your
> build area for this recipe ?
>

The ones I've added in the INSANE_SKIP

ls -lah
/home/alex/Projects/yocto/build/tmp/work/cortexa7t2hf-neon-vfpv4-poky-linux-gnueabi/node-red-node-serialport/1.0.1-r0/packages-split
total 32K
drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport
drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-dbg
drwxr-xr-x 2 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-dev
drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04 node-red-node-serialport-doc
drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04 node-red-node-serialport-locale
-rw-r--r-- 1 alex alex   57 Apr  6 16:04 node-red-node-serialport.shlibdeps
drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-src
drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04 node-red-node-serialport-staticdev

[-- Attachment #2: Type: text/html, Size: 1305 bytes --]

^ permalink raw reply	[flat|nested] 14+ messages in thread
* Re: [yocto] Skipping already-stripped check doesn't work
  2022-04-11 20:43       ` Alessandro Tagliapietra
@ 2022-04-11 21:14         ` Khem Raj
  2022-04-11 21:27           ` Alessandro Tagliapietra
  0 siblings, 1 reply; 14+ messages in thread
From: Khem Raj @ 2022-04-11 21:14 UTC (permalink / raw)
  To: Alessandro Tagliapietra; +Cc: Yocto-mailing-list

[-- Attachment #1: Type: text/plain, Size: 1263 bytes --]

On Mon, Apr 11, 2022 at 1:43 PM Alessandro Tagliapietra <
tagliapietra.alessandro@gmail.com> wrote:

> On Mon, Apr 11, 2022 at 1:36 PM Khem Raj <raj.khem@gmail.com> wrote:
>
>>
>> what package folders do you see under packages-split/ folder in your
>> build area for this recipe ?
>>
>
> The ones I've added in the INSANE_SKIP
>
> ls -lah
> /home/alex/Projects/yocto/build/tmp/work/cortexa7t2hf-neon-vfpv4-poky-linux-gnueabi/node-red-node-serialport/1.0.1-r0/packages-split
> total 32K
> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport
> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-dbg
> drwxr-xr-x 2 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-dev
> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04 node-red-node-serialport-doc
> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04 node-red-node-serialport-locale
> -rw-r--r-- 1 alex alex   57 Apr  6 16:04 node-red-node-serialport.shlibdeps
> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-src
> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04 node-red-node-serialport-staticdev
>

Ok then next thing you want to check is where the reported stripped file is
located and even if it does not work then perhaps look into removing these
files if they are not needed

>
>
>

[-- Attachment #2: Type: text/html, Size: 2120 bytes --]

^ permalink raw reply	[flat|nested] 14+ messages in thread
* Re: [yocto] Skipping already-stripped check doesn't work
  2022-04-11 21:14         ` Khem Raj
@ 2022-04-11 21:27           ` Alessandro Tagliapietra
  2022-04-11 21:29             ` Khem Raj
  0 siblings, 1 reply; 14+ messages in thread
From: Alessandro Tagliapietra @ 2022-04-11 21:27 UTC (permalink / raw)
  To: Khem Raj; +Cc: Yocto-mailing-list

[-- Attachment #1: Type: text/plain, Size: 2365 bytes --]

Removing works, the build succeeded, however I can't test if it's actually
needed by the package, I'll try that tomorrow.
Regarding file paths for example file linux-arm/node.napi.armv7.node is in
these paths:

image/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
packages-split/node-red-node-serialport/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
npm-build/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
package/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
npm/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node

so it seems to be in node-red-node-serialport which is our package
so INSANE_SKIP_${PN} += "already-stripped arch" should work.


On Mon, Apr 11, 2022 at 2:14 PM Khem Raj <raj.khem@gmail.com> wrote:

>
>
> On Mon, Apr 11, 2022 at 1:43 PM Alessandro Tagliapietra <
> tagliapietra.alessandro@gmail.com> wrote:
>
>> On Mon, Apr 11, 2022 at 1:36 PM Khem Raj <raj.khem@gmail.com> wrote:
>>
>>>
>>> what package folders do you see under packages-split/ folder in your
>>> build area for this recipe ?
>>>
>>
>> The ones I've added in the INSANE_SKIP
>>
>> ls -lah
>> /home/alex/Projects/yocto/build/tmp/work/cortexa7t2hf-neon-vfpv4-poky-linux-gnueabi/node-red-node-serialport/1.0.1-r0/packages-split
>> total 32K
>> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport
>> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-dbg
>> drwxr-xr-x 2 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-dev
>> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04 node-red-node-serialport-doc
>> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04 node-red-node-serialport-locale
>> -rw-r--r-- 1 alex alex   57 Apr  6 16:04
>> node-red-node-serialport.shlibdeps
>> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-src
>> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04
>> node-red-node-serialport-staticdev
>>
>
> Ok then next thing you want to check is where the reported stripped file
> is located and even if it does not work then perhaps look into removing
> these files if they are not needed
>
>>
>>
>>

[-- Attachment #2: Type: text/html, Size: 3619 bytes --]

^ permalink raw reply	[flat|nested] 14+ messages in thread
* Re: [yocto] Skipping already-stripped check doesn't work
  2022-04-11 21:27           ` Alessandro Tagliapietra
@ 2022-04-11 21:29             ` Khem Raj
  2022-04-11 21:41               ` Alessandro Tagliapietra
  0 siblings, 1 reply; 14+ messages in thread
From: Khem Raj @ 2022-04-11 21:29 UTC (permalink / raw)
  To: Alessandro Tagliapietra; +Cc: Yocto-mailing-list

which release branch are you using?

On Mon, Apr 11, 2022 at 2:27 PM Alessandro Tagliapietra
<tagliapietra.alessandro@gmail.com> wrote:
>
> Removing works, the build succeeded, however I can't test if it's actually needed by the package, I'll try that tomorrow.
> Regarding file paths for example file linux-arm/node.napi.armv7.node is in these paths:
>
> image/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
> packages-split/node-red-node-serialport/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
> npm-build/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
> package/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
> npm/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
>
> so it seems to be in node-red-node-serialport which is our package so INSANE_SKIP_${PN} += "already-stripped arch" should work.
>
>
> On Mon, Apr 11, 2022 at 2:14 PM Khem Raj <raj.khem@gmail.com> wrote:
>>
>>
>>
>> On Mon, Apr 11, 2022 at 1:43 PM Alessandro Tagliapietra <tagliapietra.alessandro@gmail.com> wrote:
>>>
>>> On Mon, Apr 11, 2022 at 1:36 PM Khem Raj <raj.khem@gmail.com> wrote:
>>>>
>>>>
>>>> what package folders do you see under packages-split/ folder in your
>>>> build area for this recipe ?
>>>
>>>
>>> The ones I've added in the INSANE_SKIP
>>>
>>> ls -lah /home/alex/Projects/yocto/build/tmp/work/cortexa7t2hf-neon-vfpv4-poky-linux-gnueabi/node-red-node-serialport/1.0.1-r0/packages-split
>>> total 32K
>>> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport
>>> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-dbg
>>> drwxr-xr-x 2 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-dev
>>> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04 node-red-node-serialport-doc
>>> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04 node-red-node-serialport-locale
>>> -rw-r--r-- 1 alex alex   57 Apr  6 16:04 node-red-node-serialport.shlibdeps
>>> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-src
>>> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04 node-red-node-serialport-staticdev
>>
>>
>> Ok then next thing you want to check is where the reported stripped file is located and even if it does not work then perhaps look into removing these files if they are not needed
>>>
>>>
>>>


^ permalink raw reply	[flat|nested] 14+ messages in thread
* Re: [yocto] Skipping already-stripped check doesn't work
  2022-04-11 21:29             ` Khem Raj
@ 2022-04-11 21:41               ` Alessandro Tagliapietra
  2022-04-11 22:26                 ` Alessandro Tagliapietra
  0 siblings, 1 reply; 14+ messages in thread
From: Alessandro Tagliapietra @ 2022-04-11 21:41 UTC (permalink / raw)
  To: Khem Raj; +Cc: Yocto-mailing-list

[-- Attachment #1: Type: text/plain, Size: 2835 bytes --]

I'm using honister (it's from a few months ago, I'm currently
rebuilding using the latest commit)

On Mon, Apr 11, 2022 at 2:29 PM Khem Raj <raj.khem@gmail.com> wrote:

> which release branch are you using?
>
> On Mon, Apr 11, 2022 at 2:27 PM Alessandro Tagliapietra
> <tagliapietra.alessandro@gmail.com> wrote:
> >
> > Removing works, the build succeeded, however I can't test if it's
> actually needed by the package, I'll try that tomorrow.
> > Regarding file paths for example file linux-arm/node.napi.armv7.node is
> in these paths:
> >
> >
> image/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
> >
> packages-split/node-red-node-serialport/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
> >
> npm-build/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
> >
> package/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
> >
> npm/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
> >
> > so it seems to be in node-red-node-serialport which is our package so
> INSANE_SKIP_${PN} += "already-stripped arch" should work.
> >
> >
> > On Mon, Apr 11, 2022 at 2:14 PM Khem Raj <raj.khem@gmail.com> wrote:
> >>
> >>
> >>
> >> On Mon, Apr 11, 2022 at 1:43 PM Alessandro Tagliapietra <
> tagliapietra.alessandro@gmail.com> wrote:
> >>>
> >>> On Mon, Apr 11, 2022 at 1:36 PM Khem Raj <raj.khem@gmail.com> wrote:
> >>>>
> >>>>
> >>>> what package folders do you see under packages-split/ folder in your
> >>>> build area for this recipe ?
> >>>
> >>>
> >>> The ones I've added in the INSANE_SKIP
> >>>
> >>> ls -lah
> /home/alex/Projects/yocto/build/tmp/work/cortexa7t2hf-neon-vfpv4-poky-linux-gnueabi/node-red-node-serialport/1.0.1-r0/packages-split
> >>> total 32K
> >>> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport
> >>> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-dbg
> >>> drwxr-xr-x 2 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-dev
> >>> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04 node-red-node-serialport-doc
> >>> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04
> node-red-node-serialport-locale
> >>> -rw-r--r-- 1 alex alex   57 Apr  6 16:04
> node-red-node-serialport.shlibdeps
> >>> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-src
> >>> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04
> node-red-node-serialport-staticdev
> >>
> >>
> >> Ok then next thing you want to check is where the reported stripped
> file is located and even if it does not work then perhaps look into
> removing these files if they are not needed
> >>>
> >>>
> >>>
>

[-- Attachment #2: Type: text/html, Size: 3856 bytes --]

^ permalink raw reply	[flat|nested] 14+ messages in thread
* Re: [yocto] Skipping already-stripped check doesn't work
  2022-04-11 21:41               ` Alessandro Tagliapietra
@ 2022-04-11 22:26                 ` Alessandro Tagliapietra
  2022-04-12  7:15                   ` Josef Holzmayr
  0 siblings, 1 reply; 14+ messages in thread
From: Alessandro Tagliapietra @ 2022-04-11 22:26 UTC (permalink / raw)
  To: Khem Raj; +Cc: Yocto-mailing-list

[-- Attachment #1: Type: text/plain, Size: 3089 bytes --]

Tested with updated honister branch, same error

-- 
Alessandro Tagliapietra


On Mon, Apr 11, 2022 at 2:41 PM Alessandro Tagliapietra <
tagliapietra.alessandro@gmail.com> wrote:

> I'm using honister (it's from a few months ago, I'm currently
> rebuilding using the latest commit)
>
> On Mon, Apr 11, 2022 at 2:29 PM Khem Raj <raj.khem@gmail.com> wrote:
>
>> which release branch are you using?
>>
>> On Mon, Apr 11, 2022 at 2:27 PM Alessandro Tagliapietra
>> <tagliapietra.alessandro@gmail.com> wrote:
>> >
>> > Removing works, the build succeeded, however I can't test if it's
>> actually needed by the package, I'll try that tomorrow.
>> > Regarding file paths for example file linux-arm/node.napi.armv7.node is
>> in these paths:
>> >
>> >
>> image/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
>> >
>> packages-split/node-red-node-serialport/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
>> >
>> npm-build/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
>> >
>> package/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
>> >
>> npm/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
>> >
>> > so it seems to be in node-red-node-serialport which is our package so
>> INSANE_SKIP_${PN} += "already-stripped arch" should work.
>> >
>> >
>> > On Mon, Apr 11, 2022 at 2:14 PM Khem Raj <raj.khem@gmail.com> wrote:
>> >>
>> >>
>> >>
>> >> On Mon, Apr 11, 2022 at 1:43 PM Alessandro Tagliapietra <
>> tagliapietra.alessandro@gmail.com> wrote:
>> >>>
>> >>> On Mon, Apr 11, 2022 at 1:36 PM Khem Raj <raj.khem@gmail.com> wrote:
>> >>>>
>> >>>>
>> >>>> what package folders do you see under packages-split/ folder in your
>> >>>> build area for this recipe ?
>> >>>
>> >>>
>> >>> The ones I've added in the INSANE_SKIP
>> >>>
>> >>> ls -lah
>> /home/alex/Projects/yocto/build/tmp/work/cortexa7t2hf-neon-vfpv4-poky-linux-gnueabi/node-red-node-serialport/1.0.1-r0/packages-split
>> >>> total 32K
>> >>> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport
>> >>> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-dbg
>> >>> drwxr-xr-x 2 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-dev
>> >>> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04 node-red-node-serialport-doc
>> >>> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04
>> node-red-node-serialport-locale
>> >>> -rw-r--r-- 1 alex alex   57 Apr  6 16:04
>> node-red-node-serialport.shlibdeps
>> >>> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-src
>> >>> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04
>> node-red-node-serialport-staticdev
>> >>
>> >>
>> >> Ok then next thing you want to check is where the reported stripped
>> file is located and even if it does not work then perhaps look into
>> removing these files if they are not needed
>> >>>
>> >>>
>> >>>
>>
>

[-- Attachment #2: Type: text/html, Size: 4493 bytes --]

^ permalink raw reply	[flat|nested] 14+ messages in thread
* Re: [yocto] Skipping already-stripped check doesn't work
  2022-04-11 22:26                 ` Alessandro Tagliapietra
@ 2022-04-12  7:15                   ` Josef Holzmayr
  2022-04-12 14:10                     ` Alessandro Tagliapietra
  0 siblings, 1 reply; 14+ messages in thread
From: Josef Holzmayr @ 2022-04-12  7:15 UTC (permalink / raw)
  To: Alessandro Tagliapietra; +Cc: Khem Raj, Yocto-mailing-list

As already pointed out on IRC, the only real solution is:
a) removing the shipped binaries from the install (as Khem also mentioned)
and b) making the module re-build the binaries using the cross
toolchain that the rest of the build also uses.

Greetz

Am Di., 12. Apr. 2022 um 00:26 Uhr schrieb Alessandro Tagliapietra
<tagliapietra.alessandro@gmail.com>:
>
> Tested with updated honister branch, same error
>
> --
> Alessandro Tagliapietra
>
>
> On Mon, Apr 11, 2022 at 2:41 PM Alessandro Tagliapietra <tagliapietra.alessandro@gmail.com> wrote:
>>
>> I'm using honister (it's from a few months ago, I'm currently rebuilding using the latest commit)
>>
>> On Mon, Apr 11, 2022 at 2:29 PM Khem Raj <raj.khem@gmail.com> wrote:
>>>
>>> which release branch are you using?
>>>
>>> On Mon, Apr 11, 2022 at 2:27 PM Alessandro Tagliapietra
>>> <tagliapietra.alessandro@gmail.com> wrote:
>>> >
>>> > Removing works, the build succeeded, however I can't test if it's actually needed by the package, I'll try that tomorrow.
>>> > Regarding file paths for example file linux-arm/node.napi.armv7.node is in these paths:
>>> >
>>> > image/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
>>> > packages-split/node-red-node-serialport/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
>>> > npm-build/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
>>> > package/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
>>> > npm/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
>>> >
>>> > so it seems to be in node-red-node-serialport which is our package so INSANE_SKIP_${PN} += "already-stripped arch" should work.
>>> >
>>> >
>>> > On Mon, Apr 11, 2022 at 2:14 PM Khem Raj <raj.khem@gmail.com> wrote:
>>> >>
>>> >>
>>> >>
>>> >> On Mon, Apr 11, 2022 at 1:43 PM Alessandro Tagliapietra <tagliapietra.alessandro@gmail.com> wrote:
>>> >>>
>>> >>> On Mon, Apr 11, 2022 at 1:36 PM Khem Raj <raj.khem@gmail.com> wrote:
>>> >>>>
>>> >>>>
>>> >>>> what package folders do you see under packages-split/ folder in your
>>> >>>> build area for this recipe ?
>>> >>>
>>> >>>
>>> >>> The ones I've added in the INSANE_SKIP
>>> >>>
>>> >>> ls -lah /home/alex/Projects/yocto/build/tmp/work/cortexa7t2hf-neon-vfpv4-poky-linux-gnueabi/node-red-node-serialport/1.0.1-r0/packages-split
>>> >>> total 32K
>>> >>> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport
>>> >>> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-dbg
>>> >>> drwxr-xr-x 2 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-dev
>>> >>> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04 node-red-node-serialport-doc
>>> >>> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04 node-red-node-serialport-locale
>>> >>> -rw-r--r-- 1 alex alex   57 Apr  6 16:04 node-red-node-serialport.shlibdeps
>>> >>> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport-src
>>> >>> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04 node-red-node-serialport-staticdev
>>> >>
>>> >>
>>> >> Ok then next thing you want to check is where the reported stripped file is located and even if it does not work then perhaps look into removing these files if they are not needed
>>> >>>
>>> >>>
>>> >>>
>
>
> -=-=-=-=-=-=-=-=-=-=-=-
> Links: You receive all messages sent to this group.
> You automatically follow any topics you start or reply to.
> View/Reply Online (#56729): https://lists.yoctoproject.org/g/yocto/message/56729
> Mute This Topic: https://lists.yoctoproject.org/mt/90398675/4689568
> Group Owner: yocto+owner@lists.yoctoproject.org
> Unsubscribe: https://lists.yoctoproject.org/g/yocto/unsub [jester@theyoctojester.info]
> -=-=-=-=-=-=-=-=-=-=-=-
>


^ permalink raw reply	[flat|nested] 14+ messages in thread
* Re: [yocto] Skipping already-stripped check doesn't work
  2022-04-12  7:15                   ` Josef Holzmayr
@ 2022-04-12 14:10                     ` Alessandro Tagliapietra
  0 siblings, 0 replies; 14+ messages in thread
From: Alessandro Tagliapietra @ 2022-04-12 14:10 UTC (permalink / raw)
  To: Josef Holzmayr; +Cc: Khem Raj, Yocto-mailing-list

[-- Attachment #1: Type: text/plain, Size: 4466 bytes --]

I've ended up removing the wrong arch binaries and ignoring the stripped
ones.
Unfortunately I have no idea on where to start to rebuild the binaries
using the cross toolchain, everything seems to be handled by the npm
bbclass and node-gyp.

On Tue, Apr 12, 2022 at 12:16 AM Josef Holzmayr <jester@theyoctojester.info>
wrote:

> As already pointed out on IRC, the only real solution is:
> a) removing the shipped binaries from the install (as Khem also mentioned)
> and b) making the module re-build the binaries using the cross
> toolchain that the rest of the build also uses.
>
> Greetz
>
> Am Di., 12. Apr. 2022 um 00:26 Uhr schrieb Alessandro Tagliapietra
> <tagliapietra.alessandro@gmail.com>:
> >
> > Tested with updated honister branch, same error
> >
> > --
> > Alessandro Tagliapietra
> >
> >
> > On Mon, Apr 11, 2022 at 2:41 PM Alessandro Tagliapietra <
> tagliapietra.alessandro@gmail.com> wrote:
> >>
> >> I'm using honister (it's from a few months ago, I'm currently
> rebuilding using the latest commit)
> >>
> >> On Mon, Apr 11, 2022 at 2:29 PM Khem Raj <raj.khem@gmail.com> wrote:
> >>>
> >>> which release branch are you using?
> >>>
> >>> On Mon, Apr 11, 2022 at 2:27 PM Alessandro Tagliapietra
> >>> <tagliapietra.alessandro@gmail.com> wrote:
> >>> >
> >>> > Removing works, the build succeeded, however I can't test if it's
> actually needed by the package, I'll try that tomorrow.
> >>> > Regarding file paths for example file linux-arm/node.napi.armv7.node
> is in these paths:
> >>> >
> >>> >
> image/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
> >>> >
> packages-split/node-red-node-serialport/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
> >>> >
> npm-build/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
> >>> >
> package/usr/lib/node_modules/node-red-node-serialport/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
> >>> >
> npm/node_modules/@serialport/bindings-cpp/prebuilds/linux-arm/node.napi.armv7.node
> >>> >
> >>> > so it seems to be in node-red-node-serialport which is our package
> so INSANE_SKIP_${PN} += "already-stripped arch" should work.
> >>> >
> >>> >
> >>> > On Mon, Apr 11, 2022 at 2:14 PM Khem Raj <raj.khem@gmail.com> wrote:
> >>> >>
> >>> >>
> >>> >>
> >>> >> On Mon, Apr 11, 2022 at 1:43 PM Alessandro Tagliapietra <
> tagliapietra.alessandro@gmail.com> wrote:
> >>> >>>
> >>> >>> On Mon, Apr 11, 2022 at 1:36 PM Khem Raj <raj.khem@gmail.com>
> wrote:
> >>> >>>>
> >>> >>>>
> >>> >>>> what package folders do you see under packages-split/ folder in
> your
> >>> >>>> build area for this recipe ?
> >>> >>>
> >>> >>>
> >>> >>> The ones I've added in the INSANE_SKIP
> >>> >>>
> >>> >>> ls -lah
> /home/alex/Projects/yocto/build/tmp/work/cortexa7t2hf-neon-vfpv4-poky-linux-gnueabi/node-red-node-serialport/1.0.1-r0/packages-split
> >>> >>> total 32K
> >>> >>> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23 node-red-node-serialport
> >>> >>> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23
> node-red-node-serialport-dbg
> >>> >>> drwxr-xr-x 2 alex alex 4.0K Apr 11 13:23
> node-red-node-serialport-dev
> >>> >>> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04
> node-red-node-serialport-doc
> >>> >>> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04
> node-red-node-serialport-locale
> >>> >>> -rw-r--r-- 1 alex alex   57 Apr  6 16:04
> node-red-node-serialport.shlibdeps
> >>> >>> drwxr-xr-x 3 alex alex 4.0K Apr 11 13:23
> node-red-node-serialport-src
> >>> >>> drwxr-xr-x 2 alex alex 4.0K Apr  6 16:04
> node-red-node-serialport-staticdev
> >>> >>
> >>> >>
> >>> >> Ok then next thing you want to check is where the reported stripped
> file is located and even if it does not work then perhaps look into
> removing these files if they are not needed
> >>> >>>
> >>> >>>
> >>> >>>
> >
> >
> > -=-=-=-=-=-=-=-=-=-=-=-
> > Links: You receive all messages sent to this group.
> > You automatically follow any topics you start or reply to.
> > View/Reply Online (#56729):
> https://lists.yoctoproject.org/g/yocto/message/56729
> > Mute This Topic: https://lists.yoctoproject.org/mt/90398675/4689568
> > Group Owner: yocto+owner@lists.yoctoproject.org
> > Unsubscribe: https://lists.yoctoproject.org/g/yocto/unsub [
> jester@theyoctojester.info]
> > -=-=-=-=-=-=-=-=-=-=-=-
> >
>

[-- Attachment #2: Type: text/html, Size: 6747 bytes --]

^ permalink raw reply	[flat|nested] 14+ messages in thread
* Re: [yocto] Skipping already-stripped check doesn't work
       [not found]     ` <14b889eed4e3a424b27120bd7d231ae8fcdce1df.camel@linuxfoundation.org>
@ 2022-04-12 14:11       ` Alessandro Tagliapietra
  0 siblings, 0 replies; 14+ messages in thread
From: Alessandro Tagliapietra @ 2022-04-12 14:11 UTC (permalink / raw)
  To: Richard Purdie; +Cc: Khem Raj, Yocto-mailing-list

[-- Attachment #1: Type: text/plain, Size: 1068 bytes --]

Thank you so much! That was the problem!

On Tue, Apr 12, 2022 at 1:32 AM Richard Purdie <
richard.purdie@linuxfoundation.org> wrote:

> On Mon, 2022-04-11 at 13:27 -0700, Alessandro Tagliapietra wrote:
> > Thank you for helping!
> >
> > The package is node-red-node-serialport, it doesn't seem to create child
> > packages for the dependencies, the nodejs deps only reside in the package
> > node-modules folder.
> > The packages-split only contained node-red-node-serialport-* packages.
> >
> > So I've tried to add the skips for these child packages too:
> >
> > INSANE_SKIP_${PN} += "already-stripped arch"
> > INSANE_SKIP_${PN}-dbg += "already-stripped arch"
> > INSANE_SKIP_${PN}-dev += "already-stripped arch"
> > INSANE_SKIP_${PN}-doc += "already-stripped arch"
> > INSANE_SKIP_${PN}-locale += "already-stripped arch"
> > INSANE_SKIP_${PN}-src += "already-stripped arch"
> > INSANE_SKIP_${PN}-staticdev += "already-stripped arch"
>
> For honister the syntax would be:
>
> INSANE_SKIP:${PN}
>
> as the override change applies there.
>
> Cheers,
>
> Richard
>
>

[-- Attachment #2: Type: text/html, Size: 1584 bytes --]

^ permalink raw reply	[flat|nested] 14+ messages in thread
end of thread, other threads:[~2022-04-12 16:46 UTC | newest]

Thread overview: 14+ messages (download: mbox.gz / follow: Atom feed)
-- links below jump to the message on this page --
2022-04-11 16:13 Skipping already-stripped check doesn't work Alessandro Tagliapietra
2022-04-11 18:14 ` [yocto] " Jose Quaresma
2022-04-11 18:27 ` Khem Raj
2022-04-11 20:27   ` Alessandro Tagliapietra
2022-04-11 20:36     ` Khem Raj
2022-04-11 20:43       ` Alessandro Tagliapietra
2022-04-11 21:14         ` Khem Raj
2022-04-11 21:27           ` Alessandro Tagliapietra
2022-04-11 21:29             ` Khem Raj
2022-04-11 21:41               ` Alessandro Tagliapietra
2022-04-11 22:26                 ` Alessandro Tagliapietra
2022-04-12  7:15                   ` Josef Holzmayr
2022-04-12 14:10                     ` Alessandro Tagliapietra
     [not found]     ` <14b889eed4e3a424b27120bd7d231ae8fcdce1df.camel@linuxfoundation.org>
2022-04-12 14:11       ` Alessandro Tagliapietra

