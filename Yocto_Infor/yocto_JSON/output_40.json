[
    "* [yocto-autobuilder-helper][PATCH] config.json : Fix repro-meta-oe layer dependency\n@ 2023-10-13 14:34 Fabien Thomas\n  2023-10-14 23:01 ` [yocto] \" Richard Purdie\n  0 siblings, 1 reply; 2+ messages in thread\nFrom: Fabien Thomas @ 2023-10-13 14:34 UTC (permalink / raw)\n  To: yocto; +Cc: Fabien Thomas, Yoann Congal\n\nFix meta-filesystem build issue due to hidden dependencies (not set by\nLAYERDEPENDS) smbnetfs(meta-filesystem) depends on\nsamba(meta-networking) that depends on python3-dnspython (meta-python)\n\nCreate new build-st dir for each layer to avoid chain of\nfailure between steps\n\nSigned-off-by: Fabien Thomas <fabien.thomas@smile.fr>\nReviewed-by: Yoann Congal <yoann.congal@smile.fr>\n---\n config.json | 22 ++++++++++++----------\n 1 file changed, 12 insertions(+), 10 deletions(-)\n\ndiff --git a/config.json b/config.json\nindex 3acb710..c01a453 100644\n--- a/config.json\n+++ b/config.json\n@@ -303,15 +303,17 @@\n             ],\n             \"step1\" : {\n                 \"shortname\" : \"Repro meta-oe/meta-filesystems\",\n-                \"EXTRACMDS\" : [\"${SCRIPTSDIR}/checkvnc; OEQA_DEBUGGING_SAVED_OUTPUT=${BASE_SHAREDDIR}/pub/repro-fail-openembedded/meta-filesystems/ DISPLAY=:1 oe-selftest -r reproducible\"],\n+                \"EXTRACMDS\" : [\"${SCRIPTSDIR}/checkvnc; OEQA_DEBUGGING_SAVED_OUTPUT=${BASE_SHAREDDIR}/pub/repro-fail-openembedded/meta-filesystems/ DISPLAY=:1 oe-selftest --newbuilddir $BBPATH/build-st-meta-filesystems -r reproducible\"],\n                 \"ADDLAYER\" : [\n                     \"${BUILDDIR}/../meta-openembedded/meta-oe\",\n+                    \"${BUILDDIR}/../meta-openembedded/meta-python\",\n                     \"${BUILDDIR}/../meta-openembedded/meta-networking\",\n                     \"${BUILDDIR}/../meta-openembedded/meta-filesystems\"\n                 ],\n                 \"extravars\" : [\n                     \"EXCLUDE_FROM_WORLD:layer-openembedded-layer = '1'\",\n                     \"EXCLUDE_FROM_WORLD:layer-networking-layer = '1'\",\n+                    \"EXCLUDE_FROM_WORLD:layer-meta-python = '1'\",\n                     \"USERADD_UID_TABLES:append = ' files/static-passwd-meta-filesystems'\",\n                     \"USERADD_GID_TABLES:append = ' files/static-group-meta-networking'\",\n                     \"USERADD_UID_TABLES:append = ' files/static-passwd-meta-networking'\",\n@@ -321,7 +323,7 @@\n             },\n             \"step2\" : {\n                 \"shortname\" : \"Repro meta-oe/meta-gnome\",\n-                \"EXTRACMDS\" : [\"${SCRIPTSDIR}/checkvnc; OEQA_DEBUGGING_SAVED_OUTPUT=${BASE_SHAREDDIR}/pub/repro-fail-openembedded/meta-gnome/ DISPLAY=:1 oe-selftest -r reproducible\"],\n+                \"EXTRACMDS\" : [\"${SCRIPTSDIR}/checkvnc; OEQA_DEBUGGING_SAVED_OUTPUT=${BASE_SHAREDDIR}/pub/repro-fail-openembedded/meta-gnome/ DISPLAY=:1 oe-selftest --newbuilddir $BBPATH/build-st-meta-gnome -r reproducible\"],\n                 \"ADDLAYER\" : [\n                     \"${BUILDDIR}/../meta-openembedded/meta-oe\",\n                     \"${BUILDDIR}/../meta-openembedded/meta-python\",\n@@ -341,14 +343,14 @@\n             },\n             \"step3\" : {\n                 \"shortname\" : \"Repro meta-oe/meta-initramfs\",\n-                \"EXTRACMDS\" : [\"${SCRIPTSDIR}/checkvnc; OEQA_DEBUGGING_SAVED_OUTPUT=${BASE_SHAREDDIR}/pub/repro-fail-openembedded/meta-initramfs/ DISPLAY=:1 oe-selftest -r reproducible\"],\n+                \"EXTRACMDS\" : [\"${SCRIPTSDIR}/checkvnc; OEQA_DEBUGGING_SAVED_OUTPUT=${BASE_SHAREDDIR}/pub/repro-fail-openembedded/meta-initramfs/ DISPLAY=:1 oe-selftest --newbuilddir $BBPATH/build-st-meta-initramfs -r reproducible\"],\n                 \"ADDLAYER\" : [\n                     \"${BUILDDIR}/../meta-openembedded/meta-initramfs\"\n                 ]\n             },\n             \"step4\" : {\n                 \"shortname\" : \"Repro meta-oe/meta-multimedia\",\n-                \"EXTRACMDS\" : [\"${SCRIPTSDIR}/checkvnc; OEQA_DEBUGGING_SAVED_OUTPUT=${BASE_SHAREDDIR}/pub/repro-fail-openembedded/meta-multimedia/ DISPLAY=:1 oe-selftest -r reproducible\"],\n+                \"EXTRACMDS\" : [\"${SCRIPTSDIR}/checkvnc; OEQA_DEBUGGING_SAVED_OUTPUT=${BASE_SHAREDDIR}/pub/repro-fail-openembedded/meta-multimedia/ DISPLAY=:1 oe-selftest --newbuilddir $BBPATH/build-st-meta-multimedia -r reproducible\"],\n                 \"ADDLAYER\" : [\n                     \"${BUILDDIR}/../meta-openembedded/meta-oe\",\n                     \"${BUILDDIR}/../meta-openembedded/meta-python\",\n@@ -365,7 +367,7 @@\n             },\n             \"step5\" : {\n                 \"shortname\" : \"Repro meta-oe/meta-networking\",\n-                \"EXTRACMDS\" : [\"${SCRIPTSDIR}/checkvnc; OEQA_DEBUGGING_SAVED_OUTPUT=${BASE_SHAREDDIR}/pub/repro-fail-openembedded/meta-networking/ DISPLAY=:1 oe-selftest -r reproducible\"],\n+                \"EXTRACMDS\" : [\"${SCRIPTSDIR}/checkvnc; OEQA_DEBUGGING_SAVED_OUTPUT=${BASE_SHAREDDIR}/pub/repro-fail-openembedded/meta-networking/ DISPLAY=:1 oe-selftest --newbuilddir $BBPATH/build-st-meta-networking -r reproducible\"],\n                 \"ADDLAYER\" : [\n                     \"${BUILDDIR}/../meta-openembedded/meta-oe\",\n                     \"${BUILDDIR}/../meta-openembedded/meta-networking\"\n@@ -380,7 +382,7 @@\n             },\n             \"step6\" : {\n                 \"shortname\" : \"Repro meta-oe/meta-oe\",\n-                \"EXTRACMDS\" : [\"${SCRIPTSDIR}/checkvnc; OEQA_DEBUGGING_SAVED_OUTPUT=${BASE_SHAREDDIR}/pub/repro-fail-openembedded/meta-oe/ DISPLAY=:1 oe-selftest -r reproducible\"],\n+                \"EXTRACMDS\" : [\"${SCRIPTSDIR}/checkvnc; OEQA_DEBUGGING_SAVED_OUTPUT=${BASE_SHAREDDIR}/pub/repro-fail-openembedded/meta-oe/ DISPLAY=:1 oe-selftest --newbuilddir $BBPATH/build-st-meta-oe -r reproducible\"],\n                 \"ADDLAYER\" : [\n                     \"${BUILDDIR}/../meta-openembedded/meta-oe\"\n                 ],\n@@ -391,7 +393,7 @@\n             },\n             \"step7\" : {\n                 \"shortname\" : \"Repro meta-oe/meta-perl\",\n-                \"EXTRACMDS\" : [\"${SCRIPTSDIR}/checkvnc; OEQA_DEBUGGING_SAVED_OUTPUT=${BASE_SHAREDDIR}/pub/repro-fail-openembedded/meta-perl/ DISPLAY=:1 oe-selftest -r reproducible\"],\n+                \"EXTRACMDS\" : [\"${SCRIPTSDIR}/checkvnc; OEQA_DEBUGGING_SAVED_OUTPUT=${BASE_SHAREDDIR}/pub/repro-fail-openembedded/meta-perl/ DISPLAY=:1 oe-selftest --newbuilddir $BBPATH/build-st-meta-perl -r reproducible\"],\n                 \"ADDLAYER\" : [\n                     \"${BUILDDIR}/../meta-openembedded/meta-oe\",\n                     \"${BUILDDIR}/../meta-openembedded/meta-perl\"\n@@ -406,7 +408,7 @@\n             },\n             \"step8\" : {\n                 \"shortname\" : \"Repro meta-oe/meta-python\",\n-                \"EXTRACMDS\" : [\"${SCRIPTSDIR}/checkvnc; OEQA_DEBUGGING_SAVED_OUTPUT=${BASE_SHAREDDIR}/pub/repro-fail-openembedded/meta-python/ DISPLAY=:1 oe-selftest -r reproducible\"],\n+                \"EXTRACMDS\" : [\"${SCRIPTSDIR}/checkvnc; OEQA_DEBUGGING_SAVED_OUTPUT=${BASE_SHAREDDIR}/pub/repro-fail-openembedded/meta-python/ DISPLAY=:1 oe-selftest --newbuilddir $BBPATH/build-st-meta-python -r reproducible\"],\n                 \"ADDLAYER\" : [\n                     \"${BUILDDIR}/../meta-openembedded/meta-oe\",\n                     \"${BUILDDIR}/../meta-openembedded/meta-python\"\n@@ -417,7 +419,7 @@\n             },\n             \"step9\" : {\n                 \"shortname\" : \"Repro meta-oe/meta-webserver\",\n-                \"EXTRACMDS\" : [\"${SCRIPTSDIR}/checkvnc; OEQA_DEBUGGING_SAVED_OUTPUT=${BASE_SHAREDDIR}/pub/repro-fail-openembedded/meta-webserver/ DISPLAY=:1 oe-selftest -r reproducible\"],\n+                \"EXTRACMDS\" : [\"${SCRIPTSDIR}/checkvnc; OEQA_DEBUGGING_SAVED_OUTPUT=${BASE_SHAREDDIR}/pub/repro-fail-openembedded/meta-webserver/ DISPLAY=:1 oe-selftest --newbuilddir $BBPATH/build-st-meta-webserver -r reproducible\"],\n                 \"ADDLAYER\" : [\n                     \"${BUILDDIR}/../meta-openembedded/meta-oe\",\n                     \"${BUILDDIR}/../meta-openembedded/meta-webserver\"\n@@ -431,7 +433,7 @@\n             },\n             \"step10\" : {\n                 \"shortname\" : \"Repro meta-oe/meta-xfce\",\n-                \"EXTRACMDS\" : [\"${SCRIPTSDIR}/checkvnc; OEQA_DEBUGGING_SAVED_OUTPUT=${BASE_SHAREDDIR}/pub/repro-fail-openembedded/meta-xfce/ DISPLAY=:1 oe-selftest -r reproducible\"],\n+                \"EXTRACMDS\" : [\"${SCRIPTSDIR}/checkvnc; OEQA_DEBUGGING_SAVED_OUTPUT=${BASE_SHAREDDIR}/pub/repro-fail-openembedded/meta-xfce/ DISPLAY=:1 oe-selftest --newbuilddir $BBPATH/build-st-meta-xfce -r reproducible\"],\n                 \"ADDLAYER\" : [\n                     \"${BUILDDIR}/../meta-openembedded/meta-oe\",\n                     \"${BUILDDIR}/../meta-openembedded/meta-python\",\n-- \n2.34.1\n\n\n\n^ permalink raw reply related\t[flat|nested] 2+ messages in thread",
    "* Re: [yocto] [yocto-autobuilder-helper][PATCH] config.json : Fix repro-meta-oe layer dependency\n  2023-10-13 14:34 [yocto-autobuilder-helper][PATCH] config.json : Fix repro-meta-oe layer dependency Fabien Thomas\n@ 2023-10-14 23:01 ` Richard Purdie\n  0 siblings, 0 replies; 2+ messages in thread\nFrom: Richard Purdie @ 2023-10-14 23:01 UTC (permalink / raw)\n  To: Fabien Thomas, yocto; +Cc: Yoann Congal\n\nOn Fri, 2023-10-13 at 16:34 +0200, Fabien Thomas wrote:\n> Fix meta-filesystem build issue due to hidden dependencies (not set by\n> LAYERDEPENDS) smbnetfs(meta-filesystem) depends on\n> samba(meta-networking) that depends on python3-dnspython (meta-python)\n> \n> Create new build-st dir for each layer to avoid chain of\n> failure between steps\n> \n> Signed-off-by: Fabien Thomas <fabien.thomas@smile.fr>\n> Reviewed-by: Yoann Congal <yoann.congal@smile.fr>\n> ---\n>  config.json | 22 ++++++++++++----------\n>  1 file changed, 12 insertions(+), 10 deletions(-)\n\nhttps://autobuilder.yoctoproject.org/typhoon/#/builders/155/builds/5\n\nCheers,\n\nRichard\n\n\n^ permalink raw reply\t[flat|nested] 2+ messages in thread",
    "end of thread, other threads:[~2023-10-14 23:01 UTC | newest]\n\nThread overview: 2+ messages (download: mbox.gz / follow: Atom feed)\n-- links below jump to the message on this page --\n2023-10-13 14:34 [yocto-autobuilder-helper][PATCH] config.json : Fix repro-meta-oe layer dependency Fabien Thomas\n2023-10-14 23:01 ` [yocto] \" Richard Purdie\n"
]