* [meta-selinux][PATCH 01/17] gitignore: add it
@ 2023-03-11 13:12 Yi Zhao
  2023-03-11 13:12 ` [meta-selinux][PATCH 02/17] refpolicy: update to latest git rev Yi Zhao
                   ` (15 more replies)
  0 siblings, 16 replies; 17+ messages in thread
From: Yi Zhao @ 2023-03-11 13:12 UTC (permalink / raw)
  To: yocto, joe.macdonald, joe, joe_macdonald

Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
---
 .gitignore | 7 +++++++
 1 file changed, 7 insertions(+)
 create mode 100644 .gitignore

diff --git a/.gitignore b/.gitignore
new file mode 100644
index 0000000..c01df45
--- /dev/null
+++ b/.gitignore
@@ -0,0 +1,7 @@
+*.pyc
+*.pyo
+/*.patch
+*.swp
+*.orig
+*.rej
+*~
-- 
2.25.1



^ permalink raw reply related	[flat|nested] 17+ messages in thread
* [meta-selinux][PATCH 02/17] refpolicy: update to latest git rev
  2023-03-11 13:12 [meta-selinux][PATCH 01/17] gitignore: add it Yi Zhao
@ 2023-03-11 13:12 ` Yi Zhao
  2023-03-11 13:12 ` [meta-selinux][PATCH 03/17] selinux: upgrade 3.4 -> 3.5 Yi Zhao
                   ` (14 subsequent siblings)
  15 siblings, 0 replies; 17+ messages in thread
From: Yi Zhao @ 2023-03-11 13:12 UTC (permalink / raw)
  To: yocto, joe.macdonald, joe, joe_macdonald

Drop 0003-refpolicy-minimum-make-dbus-module-optional.patch as the issue
has been fixed upstream.

Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
---
 .../refpolicy/refpolicy-minimum_git.bb        |  1 -
 ...cy-minimum-make-dbus-module-optional.patch | 36 -------------------
 recipes-security/refpolicy/refpolicy_git.inc  |  2 +-
 3 files changed, 1 insertion(+), 38 deletions(-)
 delete mode 100644 recipes-security/refpolicy/refpolicy/0003-refpolicy-minimum-make-dbus-module-optional.patch

diff --git a/recipes-security/refpolicy/refpolicy-minimum_git.bb b/recipes-security/refpolicy/refpolicy-minimum_git.bb
index a50a4cd..67c3785 100644
--- a/recipes-security/refpolicy/refpolicy-minimum_git.bb
+++ b/recipes-security/refpolicy/refpolicy-minimum_git.bb
@@ -14,7 +14,6 @@ domains are unconfined. \
 SRC_URI += " \
         file://0001-refpolicy-minimum-make-sysadmin-module-optional.patch \
         file://0002-refpolicy-minimum-make-xdg-module-optional.patch \
-        file://0003-refpolicy-minimum-make-dbus-module-optional.patch \
         "
 
 POLICY_NAME = "minimum"
diff --git a/recipes-security/refpolicy/refpolicy/0003-refpolicy-minimum-make-dbus-module-optional.patch b/recipes-security/refpolicy/refpolicy/0003-refpolicy-minimum-make-dbus-module-optional.patch
deleted file mode 100644
index d545d2a..0000000
--- a/recipes-security/refpolicy/refpolicy/0003-refpolicy-minimum-make-dbus-module-optional.patch
+++ /dev/null
@@ -1,36 +0,0 @@
-From e28807393f105a16528cb5304283bde0b771fc4e Mon Sep 17 00:00:00 2001
-From: Yi Zhao <yi.zhao@windriver.com>
-Date: Wed, 9 Nov 2022 10:53:26 +0800
-Subject: [PATCH] refpolicy-minimum: make dbus module optional
-
-The mount module invokes interface
-dbus_dontaudit_write_system_bus_runtime_named_sockets which is from dbus
-module. Since dbus is not a core moudle in sysvinit system, we could
-make this interface optional in mount module by optional_policy. Then we
-could make the minimum policy without dbus module.
-
-Upstream-Status: Inappropriate [embedded specific]
-
-Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
----
- policy/modules/system/mount.te | 4 +++-
- 1 file changed, 3 insertions(+), 1 deletion(-)
-
-diff --git a/policy/modules/system/mount.te b/policy/modules/system/mount.te
-index 97f49e58e..b59529a01 100644
---- a/policy/modules/system/mount.te
-+++ b/policy/modules/system/mount.te
-@@ -146,7 +146,9 @@ selinux_getattr_fs(mount_t)
- 
- userdom_use_all_users_fds(mount_t)
- 
--dbus_dontaudit_write_system_bus_runtime_named_sockets(mount_t)
-+optional_policy(`
-+	dbus_dontaudit_write_system_bus_runtime_named_sockets(mount_t)
-+')
- 
- ifdef(`distro_redhat',`
- 	optional_policy(`
--- 
-2.25.1
-
diff --git a/recipes-security/refpolicy/refpolicy_git.inc b/recipes-security/refpolicy/refpolicy_git.inc
index 54e0890..65bd8c8 100644
--- a/recipes-security/refpolicy/refpolicy_git.inc
+++ b/recipes-security/refpolicy/refpolicy_git.inc
@@ -2,7 +2,7 @@ PV = "2.20221101+git${SRCPV}"
 
 SRC_URI = "git://github.com/SELinuxProject/refpolicy.git;protocol=https;branch=master;name=refpolicy;destsuffix=refpolicy"
 
-SRCREV_refpolicy ?= "03d486e306555da161b653c88e804ce23f3a0ea4"
+SRCREV_refpolicy ?= "f625d5b78832dc699e2b8aed74eb53c826372a0f"
 
 UPSTREAM_CHECK_GITTAGREGEX = "RELEASE_(?P<pver>\d+_\d+)"
 
-- 
2.25.1



^ permalink raw reply related	[flat|nested] 17+ messages in thread
* [meta-selinux][PATCH 03/17] selinux: upgrade 3.4 -> 3.5
  2023-03-11 13:12 [meta-selinux][PATCH 01/17] gitignore: add it Yi Zhao
  2023-03-11 13:12 ` [meta-selinux][PATCH 02/17] refpolicy: update to latest git rev Yi Zhao
@ 2023-03-11 13:12 ` Yi Zhao
  2023-03-11 13:12 ` [meta-selinux][PATCH 04/17] libsepol: " Yi Zhao
                   ` (13 subsequent siblings)
  15 siblings, 0 replies; 17+ messages in thread
From: Yi Zhao @ 2023-03-11 13:12 UTC (permalink / raw)
  To: yocto, joe.macdonald, joe, joe_macdonald

ChangeLog:
https://github.com/SELinuxProject/selinux/releases/tag/3.5

Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
---
 recipes-security/selinux/selinux_common.inc | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/recipes-security/selinux/selinux_common.inc b/recipes-security/selinux/selinux_common.inc
index 86c748f..87e9231 100644
--- a/recipes-security/selinux/selinux_common.inc
+++ b/recipes-security/selinux/selinux_common.inc
@@ -1,7 +1,7 @@
 HOMEPAGE = "https://github.com/SELinuxProject"
 
 SRC_URI = "git://github.com/SELinuxProject/selinux.git;branch=master;protocol=https"
-SRCREV = "0a8c177dacdc1df96ea11bb8aa75e16c4fa82285"
+SRCREV = "d6e96c5929a3f1aa1dce93505edd9f0158757ac2"
 
 UPSTREAM_CHECK_GITTAGREGEX = "(?P<pver>\d+(\.\d+)+)"
 
-- 
2.25.1



^ permalink raw reply related	[flat|nested] 17+ messages in thread
* [meta-selinux][PATCH 04/17] libsepol: upgrade 3.4 -> 3.5
  2023-03-11 13:12 [meta-selinux][PATCH 01/17] gitignore: add it Yi Zhao
  2023-03-11 13:12 ` [meta-selinux][PATCH 02/17] refpolicy: update to latest git rev Yi Zhao
  2023-03-11 13:12 ` [meta-selinux][PATCH 03/17] selinux: upgrade 3.4 -> 3.5 Yi Zhao
@ 2023-03-11 13:12 ` Yi Zhao
  2023-03-11 13:12 ` [meta-selinux][PATCH 05/17] libselinux: " Yi Zhao
                   ` (12 subsequent siblings)
  15 siblings, 0 replies; 17+ messages in thread
From: Yi Zhao @ 2023-03-11 13:12 UTC (permalink / raw)
  To: yocto, joe.macdonald, joe, joe_macdonald

License-Update: Rename COPYING to LICENSE. No content changes.

* Drop backport patch.

Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
---
 ...idation-of-user-declarations-in-modu.patch | 80 -------------------
 .../{libsepol_3.4.bb => libsepol_3.5.bb}      |  4 +-
 2 files changed, 1 insertion(+), 83 deletions(-)
 delete mode 100644 recipes-security/selinux/libsepol/0001-libsepol-fix-validation-of-user-declarations-in-modu.patch
 rename recipes-security/selinux/{libsepol_3.4.bb => libsepol_3.5.bb} (78%)

diff --git a/recipes-security/selinux/libsepol/0001-libsepol-fix-validation-of-user-declarations-in-modu.patch b/recipes-security/selinux/libsepol/0001-libsepol-fix-validation-of-user-declarations-in-modu.patch
deleted file mode 100644
index 47c1806..0000000
--- a/recipes-security/selinux/libsepol/0001-libsepol-fix-validation-of-user-declarations-in-modu.patch
+++ /dev/null
@@ -1,80 +0,0 @@
-From 4831f73dd356fd72916f594dbeae44d26c93bb6b Mon Sep 17 00:00:00 2001
-From: =?UTF-8?q?Christian=20G=C3=B6ttsche?= <cgzones@googlemail.com>
-Date: Tue, 7 Jun 2022 17:01:45 +0200
-Subject: [PATCH] libsepol: fix validation of user declarations in modules
-MIME-Version: 1.0
-Content-Type: text/plain; charset=UTF-8
-Content-Transfer-Encoding: 8bit
-
-Users are allowed to be declared in modules. Modules do not get expanded
-leaving the `struct user_datum` members `exp_range` and `exp_dfltlevel`
-empty.
-Do no validate the expanded range and level for modular polices.
-
-Reported-by: bauen1 <j2468h@gmail.com>
-Signed-off-by: Christian GÃ¶ttsche <cgzones@googlemail.com>
-Acked-by: James Carter <jwcart2@gmail.com>
-
-Upstream-Status: Backport
-[https://github.com/SELinuxProject/selinux/commit/88a703399f3f44be2502fd4ecd22ac3d3c560694]
-
-Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
----
- src/policydb_validate.c | 12 ++++++------
- 1 file changed, 6 insertions(+), 6 deletions(-)
-
-diff --git a/src/policydb_validate.c b/src/policydb_validate.c
-index da18282..99d4eb7 100644
---- a/src/policydb_validate.c
-+++ b/src/policydb_validate.c
-@@ -18,7 +18,7 @@ typedef struct validate {
- typedef struct map_arg {
- 	validate_t *flavors;
- 	sepol_handle_t *handle;
--	int mls;
-+	policydb_t *policy;
- } map_arg_t;
- 
- static int create_gap_ebitmap(char **val_to_name, uint32_t nprim, ebitmap_t *gaps)
-@@ -571,7 +571,7 @@ static int validate_mls_range(mls_range_t *range, validate_t *sens, validate_t *
- 	return -1;
- }
- 
--static int validate_user_datum(sepol_handle_t *handle, user_datum_t *user, validate_t flavors[], int mls)
-+static int validate_user_datum(sepol_handle_t *handle, user_datum_t *user, validate_t flavors[], policydb_t *p)
- {
- 	if (validate_value(user->s.value, &flavors[SYM_USERS]))
- 		goto bad;
-@@ -581,9 +581,9 @@ static int validate_user_datum(sepol_handle_t *handle, user_datum_t *user, valid
- 		goto bad;
- 	if (validate_mls_semantic_level(&user->dfltlevel, &flavors[SYM_LEVELS], &flavors[SYM_CATS]))
- 		goto bad;
--	if (mls && validate_mls_range(&user->exp_range, &flavors[SYM_LEVELS], &flavors[SYM_CATS]))
-+	if (p->mls && p->policy_type != POLICY_MOD && validate_mls_range(&user->exp_range, &flavors[SYM_LEVELS], &flavors[SYM_CATS]))
- 		goto bad;
--	if (mls && validate_mls_level(&user->exp_dfltlevel, &flavors[SYM_LEVELS], &flavors[SYM_CATS]))
-+	if (p->mls && p->policy_type != POLICY_MOD && validate_mls_level(&user->exp_dfltlevel, &flavors[SYM_LEVELS], &flavors[SYM_CATS]))
- 		goto bad;
- 	if (user->bounds && validate_value(user->bounds, &flavors[SYM_USERS]))
- 		goto bad;
-@@ -599,7 +599,7 @@ static int validate_user_datum_wrapper(__attribute__((unused)) hashtab_key_t k,
- {
- 	map_arg_t *margs = args;
- 
--	return validate_user_datum(margs->handle, d, margs->flavors, margs->mls);
-+	return validate_user_datum(margs->handle, d, margs->flavors, margs->policy);
- }
- 
- static int validate_bool_datum(sepol_handle_t *handle, cond_bool_datum_t *boolean, validate_t flavors[])
-@@ -689,7 +689,7 @@ static int validate_datum(__attribute__ ((unused))hashtab_key_t k, hashtab_datum
- 
- static int validate_datum_array_entries(sepol_handle_t *handle, policydb_t *p, validate_t flavors[])
- {
--	map_arg_t margs = { flavors, handle, p->mls };
-+	map_arg_t margs = { flavors, handle, p };
- 
- 	if (hashtab_map(p->p_commons.table, validate_common_datum_wrapper, &margs))
- 		goto bad;
--- 
-2.25.1
-
diff --git a/recipes-security/selinux/libsepol_3.4.bb b/recipes-security/selinux/libsepol_3.5.bb
similarity index 78%
rename from recipes-security/selinux/libsepol_3.4.bb
rename to recipes-security/selinux/libsepol_3.5.bb
index e756557..0c28e9b 100644
--- a/recipes-security/selinux/libsepol_3.4.bb
+++ b/recipes-security/selinux/libsepol_3.5.bb
@@ -5,14 +5,12 @@ as by programs like load_policy that need to perform specific transformations \
 on binary policies such as customizing policy boolean settings."
 SECTION = "base"
 LICENSE = "LGPL-2.0-or-later"
-LIC_FILES_CHKSUM = "file://${S}/COPYING;md5=a6f89e2100d9b6cdffcea4f398e37343"
+LIC_FILES_CHKSUM = "file://${S}/LICENSE;md5=a6f89e2100d9b6cdffcea4f398e37343"
 
 require selinux_common.inc
 
 inherit lib_package
 
-SRC_URI += "file://0001-libsepol-fix-validation-of-user-declarations-in-modu.patch"
-
 S = "${WORKDIR}/git/libsepol"
 
 DEPENDS = "flex-native"
-- 
2.25.1



^ permalink raw reply related	[flat|nested] 17+ messages in thread
* [meta-selinux][PATCH 05/17] libselinux: upgrade 3.4 -> 3.5
  2023-03-11 13:12 [meta-selinux][PATCH 01/17] gitignore: add it Yi Zhao
                   ` (2 preceding siblings ...)
  2023-03-11 13:12 ` [meta-selinux][PATCH 04/17] libsepol: " Yi Zhao
@ 2023-03-11 13:12 ` Yi Zhao
  2023-03-11 13:12 ` [meta-selinux][PATCH 06/17] libselinux-python: " Yi Zhao
                   ` (11 subsequent siblings)
  15 siblings, 0 replies; 17+ messages in thread
From: Yi Zhao @ 2023-03-11 13:12 UTC (permalink / raw)
  To: yocto, joe.macdonald, joe, joe_macdonald

Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
---
 recipes-security/selinux/{libselinux_3.4.bb => libselinux_3.5.bb} | 0
 1 file changed, 0 insertions(+), 0 deletions(-)
 rename recipes-security/selinux/{libselinux_3.4.bb => libselinux_3.5.bb} (100%)

diff --git a/recipes-security/selinux/libselinux_3.4.bb b/recipes-security/selinux/libselinux_3.5.bb
similarity index 100%
rename from recipes-security/selinux/libselinux_3.4.bb
rename to recipes-security/selinux/libselinux_3.5.bb
-- 
2.25.1



^ permalink raw reply	[flat|nested] 17+ messages in thread
* [meta-selinux][PATCH 06/17] libselinux-python: upgrade 3.4 -> 3.5
  2023-03-11 13:12 [meta-selinux][PATCH 01/17] gitignore: add it Yi Zhao
                   ` (3 preceding siblings ...)
  2023-03-11 13:12 ` [meta-selinux][PATCH 05/17] libselinux: " Yi Zhao
@ 2023-03-11 13:12 ` Yi Zhao
  2023-03-11 13:12 ` [meta-selinux][PATCH 07/17] libsemanage: " Yi Zhao
                   ` (10 subsequent siblings)
  15 siblings, 0 replies; 17+ messages in thread
From: Yi Zhao @ 2023-03-11 13:12 UTC (permalink / raw)
  To: yocto, joe.macdonald, joe, joe_macdonald

* Add dependency python3-setuptools-scm-native to fix build error.
* Refresh patches.

Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
---
 ...inux-python_3.4.bb => libselinux-python_3.5.bb} | 14 +++++++++-----
 ...x-python-modules-install-path-for-multili.patch | 10 +++++-----
 ...PYCEXT-and-rely-on-the-installed-file-nam.patch | 10 +++++-----
 3 files changed, 19 insertions(+), 15 deletions(-)
 rename recipes-security/selinux/{libselinux-python_3.4.bb => libselinux-python_3.5.bb} (76%)

diff --git a/recipes-security/selinux/libselinux-python_3.4.bb b/recipes-security/selinux/libselinux-python_3.5.bb
similarity index 76%
rename from recipes-security/selinux/libselinux-python_3.4.bb
rename to recipes-security/selinux/libselinux-python_3.5.bb
index a850369..3555a72 100644
--- a/recipes-security/selinux/libselinux-python_3.4.bb
+++ b/recipes-security/selinux/libselinux-python_3.5.bb
@@ -18,7 +18,7 @@ SRC_URI += "\
 
 S = "${WORKDIR}/git/libselinux"
 
-DEPENDS = "libsepol libpcre2 swig-native"
+DEPENDS = "libsepol libpcre2 swig-native python3-setuptools-scm-native"
 DEPENDS:append:libc-musl = " fts"
 
 RDEPENDS:${PN} = "libselinux python3-core python3-shell"
@@ -33,12 +33,12 @@ def get_policyconfigarch(d):
 EXTRA_OEMAKE = "${@get_policyconfigarch(d)}"
 EXTRA_OEMAKE:append:libc-musl = " FTS_LDLIBS=-lfts"
 
-FILES:${PN} = "${libdir}/python${PYTHON_BASEVERSION}/site-packages/*"
+FILES:${PN} = "${PYTHON_SITEPACKAGES_DIR}/*"
 INSANE_SKIP:${PN} = "dev-so"
 
 do_compile() {
     oe_runmake pywrap -j1 \
-        PYLIBVER='python${PYTHON_BASEVERSION}${PYTHON_ABI}' \
+        PYLIBVER='python${PYTHON_BASEVERSION}' \
         PYINC='-I${STAGING_INCDIR}/${PYLIBVER}' \
         PYLIBS='-L${STAGING_LIBDIR}/${PYLIBVER} -l${PYLIBVER}'
 }
@@ -46,6 +46,10 @@ do_compile() {
 do_install() {
     oe_runmake install-pywrap \
         DESTDIR=${D} \
-        PYLIBVER='python${PYTHON_BASEVERSION}${PYTHON_ABI}' \
-        PYTHONLIBDIR='${libdir}/python${PYTHON_BASEVERSION}/site-packages'
+        PYLIBVER='python${PYTHON_BASEVERSION}' \
+        PYTHONLIBDIR='${PYTHON_SITEPACKAGES_DIR}'
+
+    # Fix buildpaths issue
+    sed -i -e 's,${WORKDIR},,g' \
+        ${D}${PYTHON_SITEPACKAGES_DIR}/selinux-${PV}.dist-info/direct_url.json
 }
diff --git a/recipes-security/selinux/libselinux/0001-Makefile-fix-python-modules-install-path-for-multili.patch b/recipes-security/selinux/libselinux/0001-Makefile-fix-python-modules-install-path-for-multili.patch
index 9750cd6..1b9dfbb 100644
--- a/recipes-security/selinux/libselinux/0001-Makefile-fix-python-modules-install-path-for-multili.patch
+++ b/recipes-security/selinux/libselinux/0001-Makefile-fix-python-modules-install-path-for-multili.patch
@@ -1,4 +1,4 @@
-From 1ff60a36bb0bfc95ce33cf950f58e121548a3c8a Mon Sep 17 00:00:00 2001
+From 57a087de68d6f7fe955268ee36b523cbe7c0c6db Mon Sep 17 00:00:00 2001
 From: Yi Zhao <yi.zhao@windriver.com>
 Date: Mon, 13 Apr 2020 12:44:23 +0800
 Subject: [PATCH] Makefile: fix python modules install path for multilib
@@ -11,15 +11,15 @@ Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
  1 file changed, 1 insertion(+), 1 deletion(-)
 
 diff --git a/src/Makefile b/src/Makefile
-index 04bf4f2..81ae6a2 100644
+index 36d5712..983f8af 100644
 --- a/src/Makefile
 +++ b/src/Makefile
-@@ -181,7 +181,7 @@ install: all
+@@ -187,7 +187,7 @@ install: all
  	ln -sf --relative $(DESTDIR)$(SHLIBDIR)/$(LIBSO) $(DESTDIR)$(LIBDIR)/$(TARGET)
  
  install-pywrap: pywrap
--	$(PYTHON) setup.py install --prefix=$(PREFIX) `test -n "$(DESTDIR)" && echo --root $(DESTDIR)` $(PYTHON_SETUP_ARGS)
-+	$(PYTHON) setup.py install --prefix=$(PREFIX) --root=$(DESTDIR) --install-lib=$(PYTHONLIBDIR) $(PYTHON_SETUP_ARGS)
+-	$(PYTHON) -m pip install --prefix=$(PREFIX) `test -n "$(DESTDIR)" && echo --root $(DESTDIR) --ignore-installed --no-deps` $(PYTHON_SETUP_ARGS) .
++	$(PYTHON) -m pip install --prefix=$(PREFIX) --root $(DESTDIR) --ignore-installed --no-deps $(PYTHON_SETUP_ARGS) .
  	install -m 644 $(SWIGPYOUT) $(DESTDIR)$(PYTHONLIBDIR)/selinux/__init__.py
  	ln -sf --relative $(DESTDIR)$(PYTHONLIBDIR)/selinux/_selinux$(PYCEXT) $(DESTDIR)$(PYTHONLIBDIR)/_selinux$(PYCEXT)
  
diff --git a/recipes-security/selinux/libselinux/0002-Do-not-use-PYCEXT-and-rely-on-the-installed-file-nam.patch b/recipes-security/selinux/libselinux/0002-Do-not-use-PYCEXT-and-rely-on-the-installed-file-nam.patch
index db7d68f..cd5510d 100644
--- a/recipes-security/selinux/libselinux/0002-Do-not-use-PYCEXT-and-rely-on-the-installed-file-nam.patch
+++ b/recipes-security/selinux/libselinux/0002-Do-not-use-PYCEXT-and-rely-on-the-installed-file-nam.patch
@@ -1,4 +1,4 @@
-From dae53d7cd4d7875f7fb7aba016a0331559044eea Mon Sep 17 00:00:00 2001
+From 1454521f2b9f2cbc3c40177aae9c260ec8966ae0 Mon Sep 17 00:00:00 2001
 From: Thomas Petazzoni <thomas.petazzoni@bootlin.com>
 Date: Fri, 25 Oct 2019 13:37:14 +0200
 Subject: [PATCH] Do not use PYCEXT, and rely on the installed file name
@@ -27,20 +27,20 @@ Signed-off-by: Changqing Li <changqing.li@windriver.com>
  1 file changed, 1 insertion(+), 2 deletions(-)
 
 diff --git a/src/Makefile b/src/Makefile
-index 81ae6a2..37399e1 100644
+index 983f8af..3d777bb 100644
 --- a/src/Makefile
 +++ b/src/Makefile
 @@ -15,7 +15,6 @@ INCLUDEDIR ?= $(PREFIX)/include
  PYINC ?= $(shell $(PKG_CONFIG) --cflags $(PYPREFIX))
  PYLIBS ?= $(shell $(PKG_CONFIG) --libs $(PYPREFIX))
- PYTHONLIBDIR ?= $(shell $(PYTHON) -c "from distutils.sysconfig import *; print(get_python_lib(plat_specific=1, prefix='$(PREFIX)'))")
+ PYTHONLIBDIR ?= $(shell $(PYTHON) -c "import sysconfig; print(sysconfig.get_path('platlib', vars={'platbase': '$(PREFIX)', 'base': '$(PREFIX)'}))")
 -PYCEXT ?= $(shell $(PYTHON) -c 'import importlib.machinery;print(importlib.machinery.EXTENSION_SUFFIXES[0])')
  RUBYINC ?= $(shell $(RUBY) -e 'puts "-I" + RbConfig::CONFIG["rubyarchhdrdir"] + " -I" + RbConfig::CONFIG["rubyhdrdir"]')
  RUBYLIBS ?= $(shell $(RUBY) -e 'puts "-L" + RbConfig::CONFIG["libdir"] + " -L" + RbConfig::CONFIG["archlibdir"] + " " + RbConfig::CONFIG["LIBRUBYARG_SHARED"]')
  RUBYINSTALL ?= $(shell $(RUBY) -e 'puts RbConfig::CONFIG["vendorarchdir"]')
-@@ -183,7 +182,7 @@ install: all
+@@ -189,7 +188,7 @@ install: all
  install-pywrap: pywrap
- 	$(PYTHON) setup.py install --prefix=$(PREFIX) --root=$(DESTDIR) --install-lib=$(PYTHONLIBDIR) $(PYTHON_SETUP_ARGS)
+ 	$(PYTHON) -m pip install --prefix=$(PREFIX) --root $(DESTDIR) --ignore-installed --no-deps $(PYTHON_SETUP_ARGS) .
  	install -m 644 $(SWIGPYOUT) $(DESTDIR)$(PYTHONLIBDIR)/selinux/__init__.py
 -	ln -sf --relative $(DESTDIR)$(PYTHONLIBDIR)/selinux/_selinux$(PYCEXT) $(DESTDIR)$(PYTHONLIBDIR)/_selinux$(PYCEXT)
 +	ln -sf --relative $(DESTDIR)$(PYTHONLIBDIR)/selinux/_selinux*.so $(DESTDIR)$(PYTHONLIBDIR)/
-- 
2.25.1



^ permalink raw reply related	[flat|nested] 17+ messages in thread
* [meta-selinux][PATCH 07/17] libsemanage: upgrade 3.4 -> 3.5
  2023-03-11 13:12 [meta-selinux][PATCH 01/17] gitignore: add it Yi Zhao
                   ` (4 preceding siblings ...)
  2023-03-11 13:12 ` [meta-selinux][PATCH 06/17] libselinux-python: " Yi Zhao
@ 2023-03-11 13:12 ` Yi Zhao
  2023-03-11 13:12 ` [meta-selinux][PATCH 08/17] checkpolicy: " Yi Zhao
                   ` (9 subsequent siblings)
  15 siblings, 0 replies; 17+ messages in thread
From: Yi Zhao @ 2023-03-11 13:12 UTC (permalink / raw)
  To: yocto, joe.macdonald, joe, joe_macdonald

License-Update: Rename COPYING to LICENSE. No content changes.

Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
---
 .../{libsemanage_3.4.bb => libsemanage_3.5.bb}      | 13 +++++++------
 1 file changed, 7 insertions(+), 6 deletions(-)
 rename recipes-security/selinux/{libsemanage_3.4.bb => libsemanage_3.5.bb} (78%)

diff --git a/recipes-security/selinux/libsemanage_3.4.bb b/recipes-security/selinux/libsemanage_3.5.bb
similarity index 78%
rename from recipes-security/selinux/libsemanage_3.4.bb
rename to recipes-security/selinux/libsemanage_3.5.bb
index 7f038ac..93eb870 100644
--- a/recipes-security/selinux/libsemanage_3.4.bb
+++ b/recipes-security/selinux/libsemanage_3.5.bb
@@ -5,7 +5,7 @@ as by programs like load_policy that need to perform specific transformations \
 on binary policies such as customizing policy boolean settings."
 SECTION = "base"
 LICENSE = "LGPL-2.1-or-later"
-LIC_FILES_CHKSUM = "file://${S}/COPYING;md5=a6f89e2100d9b6cdffcea4f398e37343"
+LIC_FILES_CHKSUM = "file://${S}/LICENSE;md5=a6f89e2100d9b6cdffcea4f398e37343"
 
 require selinux_common.inc
 
@@ -29,23 +29,24 @@ PACKAGES =+ "${PN}-python"
 # For /usr/libexec/selinux/semanage_migrate_store
 RDEPENDS:${PN}-python = "python3-core"
 
-FILES:${PN}-python = "${libdir}/python${PYTHON_BASEVERSION}/site-packages/* \
+FILES:${PN}-python = "${PYTHON_SITEPACKAGES_DIR}/* \
                       ${libexecdir}/selinux/semanage_migrate_store"
-FILES:${PN}-dbg += "${libdir}/python${PYTHON_BASEVERSION}/site-packages/.debug/*"
+FILES:${PN}-dbg += "${PYTHON_SITEPACKAGES_DIR}/.debug/*"
 FILES:${PN} += "${libexecdir}"
 
 do_compile:append() {
     oe_runmake pywrap \
-        PYLIBVER='python${PYTHON_BASEVERSION}${PYTHON_ABI}' \
+        PYLIBVER='python${PYTHON_BASEVERSION}' \
         PYINC='-I${STAGING_INCDIR}/${PYLIBVER}' \
         PYLIBS='-L${STAGING_LIBDIR}/${PYLIBVER} -l${PYLIBVER}'
 }
 
 do_install:append() {
     oe_runmake install-pywrap \
+        DESTDIR=${D} \
         PYCEXT='.so' \
-        PYLIBVER='python${PYTHON_BASEVERSION}${PYTHON_ABI}' \
-        PYTHONLIBDIR='${D}${libdir}/python${PYTHON_BASEVERSION}/site-packages'
+        PYLIBVER='python${PYTHON_BASEVERSION}' \
+        PYTHONLIBDIR='${PYTHON_SITEPACKAGES_DIR}'
 
     # Update "policy-version" for semanage.conf
     sed -i 's/^#\s*\(policy-version\s*=\).*$/\1 33/' \
-- 
2.25.1



^ permalink raw reply related	[flat|nested] 17+ messages in thread
* [meta-selinux][PATCH 08/17] checkpolicy: upgrade 3.4 -> 3.5
  2023-03-11 13:12 [meta-selinux][PATCH 01/17] gitignore: add it Yi Zhao
                   ` (5 preceding siblings ...)
  2023-03-11 13:12 ` [meta-selinux][PATCH 07/17] libsemanage: " Yi Zhao
@ 2023-03-11 13:12 ` Yi Zhao
  2023-03-11 13:13 ` [meta-selinux][PATCH 09/17] secilc: " Yi Zhao
                   ` (8 subsequent siblings)
  15 siblings, 0 replies; 17+ messages in thread
From: Yi Zhao @ 2023-03-11 13:12 UTC (permalink / raw)
  To: yocto, joe.macdonald, joe, joe_macdonald

License-Update: Rename COPYING to LICENSE. No content changes.

Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
---
 .../selinux/{checkpolicy_3.4.bb => checkpolicy_3.5.bb}          | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
 rename recipes-security/selinux/{checkpolicy_3.4.bb => checkpolicy_3.5.bb} (91%)

diff --git a/recipes-security/selinux/checkpolicy_3.4.bb b/recipes-security/selinux/checkpolicy_3.5.bb
similarity index 91%
rename from recipes-security/selinux/checkpolicy_3.4.bb
rename to recipes-security/selinux/checkpolicy_3.5.bb
index 3df1bbb..60f506d 100644
--- a/recipes-security/selinux/checkpolicy_3.4.bb
+++ b/recipes-security/selinux/checkpolicy_3.5.bb
@@ -7,7 +7,7 @@ with low level details of the policy that have not been \
 encapsulated/abstracted by a proper shared library interface."
 SECTION = "base"
 LICENSE = "GPL-2.0-or-later"
-LIC_FILES_CHKSUM = "file://${S}/COPYING;md5=393a5ca445f6965873eca0259a17f833"
+LIC_FILES_CHKSUM = "file://${S}/LICENSE;md5=393a5ca445f6965873eca0259a17f833"
 
 require selinux_common.inc
 
-- 
2.25.1



^ permalink raw reply related	[flat|nested] 17+ messages in thread
* [meta-selinux][PATCH 09/17] secilc: upgrade 3.4 -> 3.5
  2023-03-11 13:12 [meta-selinux][PATCH 01/17] gitignore: add it Yi Zhao
                   ` (6 preceding siblings ...)
  2023-03-11 13:12 ` [meta-selinux][PATCH 08/17] checkpolicy: " Yi Zhao
@ 2023-03-11 13:13 ` Yi Zhao
  2023-03-11 13:13 ` [meta-selinux][PATCH 10/17] policycoreutils: " Yi Zhao
                   ` (7 subsequent siblings)
  15 siblings, 0 replies; 17+ messages in thread
From: Yi Zhao @ 2023-03-11 13:13 UTC (permalink / raw)
  To: yocto, joe.macdonald, joe, joe_macdonald

License-Update: Rename COPYING to LICENSE. No content changes.

Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
---
 recipes-security/selinux/{secilc_3.4.bb => secilc_3.5.bb} | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
 rename recipes-security/selinux/{secilc_3.4.bb => secilc_3.5.bb} (84%)

diff --git a/recipes-security/selinux/secilc_3.4.bb b/recipes-security/selinux/secilc_3.5.bb
similarity index 84%
rename from recipes-security/selinux/secilc_3.4.bb
rename to recipes-security/selinux/secilc_3.5.bb
index e30cd3a..5e0da3f 100644
--- a/recipes-security/selinux/secilc_3.4.bb
+++ b/recipes-security/selinux/secilc_3.5.bb
@@ -4,7 +4,7 @@ This package contains secilc, the SELinux Common Intermediate \
 Language (CIL) compiler."
 SECTION = "base"
 LICENSE = "BSD-2-Clause"
-LIC_FILES_CHKSUM = "file://${S}/COPYING;md5=c7e802b9a3b0c2c852669864c08b9138"
+LIC_FILES_CHKSUM = "file://${S}/LICENSE;md5=c7e802b9a3b0c2c852669864c08b9138"
 
 require selinux_common.inc
 
-- 
2.25.1



^ permalink raw reply related	[flat|nested] 17+ messages in thread
* [meta-selinux][PATCH 10/17] policycoreutils: upgrade 3.4 -> 3.5
  2023-03-11 13:12 [meta-selinux][PATCH 01/17] gitignore: add it Yi Zhao
                   ` (7 preceding siblings ...)
  2023-03-11 13:13 ` [meta-selinux][PATCH 09/17] secilc: " Yi Zhao
@ 2023-03-11 13:13 ` Yi Zhao
  2023-03-11 13:13 ` [meta-selinux][PATCH 11/17] mcstrans: " Yi Zhao
                   ` (6 subsequent siblings)
  15 siblings, 0 replies; 17+ messages in thread
From: Yi Zhao @ 2023-03-11 13:13 UTC (permalink / raw)
  To: yocto, joe.macdonald, joe, joe_macdonald

License-Update: Rename COPYING to LICENSE. No content changes.

* Refresh patch.

Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
---
 .../policycoreutils-fixfiles-de-bashify.patch             | 8 ++++----
 .../{policycoreutils_3.4.bb => policycoreutils_3.5.bb}    | 4 ++--
 2 files changed, 6 insertions(+), 6 deletions(-)
 rename recipes-security/selinux/{policycoreutils_3.4.bb => policycoreutils_3.5.bb} (97%)

diff --git a/recipes-security/selinux/policycoreutils/policycoreutils-fixfiles-de-bashify.patch b/recipes-security/selinux/policycoreutils/policycoreutils-fixfiles-de-bashify.patch
index 0e80959..5dcb5e4 100644
--- a/recipes-security/selinux/policycoreutils/policycoreutils-fixfiles-de-bashify.patch
+++ b/recipes-security/selinux/policycoreutils/policycoreutils-fixfiles-de-bashify.patch
@@ -1,4 +1,4 @@
-From cdc8f6e887d9ab8944e3ae89dd18bf55edf080c4 Mon Sep 17 00:00:00 2001
+From 624d6231ca9daf494e33352d562ff97cb0219f2d Mon Sep 17 00:00:00 2001
 From: Joe MacDonald <joe_macdonald@mentor.com>
 Date: Fri, 20 Feb 2015 17:00:19 -0500
 Subject: [PATCH] fixfiles: de-bashify
@@ -19,7 +19,7 @@ Signed-off-by: Wenzong Fan <wenzong.fan@windriver.com>
  1 file changed, 14 insertions(+), 9 deletions(-)
 
 diff --git a/scripts/fixfiles b/scripts/fixfiles
-index c72ca0e..143cc2e 100755
+index 166af6f..a23cdc6 100755
 --- a/scripts/fixfiles
 +++ b/scripts/fixfiles
 @@ -1,4 +1,4 @@
@@ -74,8 +74,8 @@ index c72ca0e..143cc2e 100755
 +    fi
  }
  
- #
-@@ -295,7 +300,7 @@ relabel() {
+ # unmount tmp bind mount before exit
+@@ -315,7 +320,7 @@ relabel() {
  	exit 1
      fi
  
diff --git a/recipes-security/selinux/policycoreutils_3.4.bb b/recipes-security/selinux/policycoreutils_3.5.bb
similarity index 97%
rename from recipes-security/selinux/policycoreutils_3.4.bb
rename to recipes-security/selinux/policycoreutils_3.5.bb
index ab871a3..c106ee7 100644
--- a/recipes-security/selinux/policycoreutils_3.4.bb
+++ b/recipes-security/selinux/policycoreutils_3.5.bb
@@ -6,7 +6,7 @@ to switch roles, and run_init to run /etc/init.d scripts in the proper \
 context."
 SECTION = "base"
 LICENSE = "GPL-2.0-or-later"
-LIC_FILES_CHKSUM = "file://${S}/COPYING;md5=393a5ca445f6965873eca0259a17f833"
+LIC_FILES_CHKSUM = "file://${S}/LICENSE;md5=393a5ca445f6965873eca0259a17f833"
 
 require selinux_common.inc
 
@@ -136,7 +136,7 @@ do_compile:prepend() {
     export PYLIBVER='python${PYTHON_BASEVERSION}'
     export PYTHON_CPPFLAGS="-I${STAGING_INCDIR}/${PYLIBVER}"
     export PYTHON_LDFLAGS="${STAGING_LIBDIR}/lib${PYLIBVER}.so"
-    export PYTHON_SITE_PKG="${libdir}/${PYLIBVER}/site-packages"
+    export PYTHON_SITE_PKG="${PYTHON_SITEPACKAGES_DIR}"
 }
 
 do_compile:class-native() {
-- 
2.25.1



^ permalink raw reply related	[flat|nested] 17+ messages in thread
* [meta-selinux][PATCH 11/17] mcstrans: upgrade 3.4 -> 3.5
  2023-03-11 13:12 [meta-selinux][PATCH 01/17] gitignore: add it Yi Zhao
                   ` (8 preceding siblings ...)
  2023-03-11 13:13 ` [meta-selinux][PATCH 10/17] policycoreutils: " Yi Zhao
@ 2023-03-11 13:13 ` Yi Zhao
  2023-03-11 13:13 ` [meta-selinux][PATCH 12/17] restorecond: " Yi Zhao
                   ` (5 subsequent siblings)
  15 siblings, 0 replies; 17+ messages in thread
From: Yi Zhao @ 2023-03-11 13:13 UTC (permalink / raw)
  To: yocto, joe.macdonald, joe, joe_macdonald

License-Update: Rename COPYING to LICENSE. No content changes.

Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
---
 recipes-security/selinux/{mcstrans_3.4.bb => mcstrans_3.5.bb} | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
 rename recipes-security/selinux/{mcstrans_3.4.bb => mcstrans_3.5.bb} (96%)

diff --git a/recipes-security/selinux/mcstrans_3.4.bb b/recipes-security/selinux/mcstrans_3.5.bb
similarity index 96%
rename from recipes-security/selinux/mcstrans_3.4.bb
rename to recipes-security/selinux/mcstrans_3.5.bb
index b5d6b54..4a8482f 100644
--- a/recipes-security/selinux/mcstrans_3.4.bb
+++ b/recipes-security/selinux/mcstrans_3.5.bb
@@ -5,7 +5,7 @@ mcstrans provides an translation daemon to translate SELinux categories \
 from internal representations to user defined representation."
 SECTION = "base"
 LICENSE = "GPL-2.0-or-later"
-LIC_FILES_CHKSUM = "file://${S}/COPYING;md5=94d55d512a9ba36caa9b7df079bae19f"
+LIC_FILES_CHKSUM = "file://${S}/LICENSE;md5=94d55d512a9ba36caa9b7df079bae19f"
 
 require selinux_common.inc
 
-- 
2.25.1



^ permalink raw reply related	[flat|nested] 17+ messages in thread
* [meta-selinux][PATCH 12/17] restorecond: upgrade 3.4 -> 3.5
  2023-03-11 13:12 [meta-selinux][PATCH 01/17] gitignore: add it Yi Zhao
                   ` (9 preceding siblings ...)
  2023-03-11 13:13 ` [meta-selinux][PATCH 11/17] mcstrans: " Yi Zhao
@ 2023-03-11 13:13 ` Yi Zhao
  2023-03-11 13:13 ` [meta-selinux][PATCH 13/17] selinux-python: " Yi Zhao
                   ` (4 subsequent siblings)
  15 siblings, 0 replies; 17+ messages in thread
From: Yi Zhao @ 2023-03-11 13:13 UTC (permalink / raw)
  To: yocto, joe.macdonald, joe, joe_macdonald

License-Update: Rename COPYING to LICENSE. No content changes.

Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
---
 .../selinux/{restorecond_3.4.bb => restorecond_3.5.bb}          | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
 rename recipes-security/selinux/{restorecond_3.4.bb => restorecond_3.5.bb} (94%)

diff --git a/recipes-security/selinux/restorecond_3.4.bb b/recipes-security/selinux/restorecond_3.5.bb
similarity index 94%
rename from recipes-security/selinux/restorecond_3.4.bb
rename to recipes-security/selinux/restorecond_3.5.bb
index 5b690d8..8e57283 100644
--- a/recipes-security/selinux/restorecond_3.4.bb
+++ b/recipes-security/selinux/restorecond_3.5.bb
@@ -6,7 +6,7 @@ will make sure they have the correct file context associated with \
 the policy."
 SECTION = "base"
 LICENSE = "GPL-2.0-or-later"
-LIC_FILES_CHKSUM = "file://${S}/COPYING;md5=393a5ca445f6965873eca0259a17f833"
+LIC_FILES_CHKSUM = "file://${S}/LICENSE;md5=393a5ca445f6965873eca0259a17f833"
 
 require selinux_common.inc
 
-- 
2.25.1



^ permalink raw reply related	[flat|nested] 17+ messages in thread
* [meta-selinux][PATCH 13/17] selinux-python: upgrade 3.4 -> 3.5
  2023-03-11 13:12 [meta-selinux][PATCH 01/17] gitignore: add it Yi Zhao
                   ` (10 preceding siblings ...)
  2023-03-11 13:13 ` [meta-selinux][PATCH 12/17] restorecond: " Yi Zhao
@ 2023-03-11 13:13 ` Yi Zhao
  2023-03-11 13:13 ` [meta-selinux][PATCH 14/17] selinux-dbus: " Yi Zhao
                   ` (3 subsequent siblings)
  15 siblings, 0 replies; 17+ messages in thread
From: Yi Zhao @ 2023-03-11 13:13 UTC (permalink / raw)
  To: yocto, joe.macdonald, joe, joe_macdonald

License-Update: Rename COPYING to LICENSE. No content changes.

* Refresh patch.
* Drop backport patch.
* Add dependency python3-setuptools-scm-native to fix build error.

Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
---
 ...andle-unsupported-languages-properly.patch | 173 ------------------
 .../fix-sepolicy-install-path.patch           |   8 +-
 ...ux-python_3.4.bb => selinux-python_3.5.bb} |  24 ++-
 3 files changed, 19 insertions(+), 186 deletions(-)
 delete mode 100644 recipes-security/selinux/selinux-python/0001-gettext-handle-unsupported-languages-properly.patch
 rename recipes-security/selinux/{selinux-python_3.4.bb => selinux-python_3.5.bb} (79%)

diff --git a/recipes-security/selinux/selinux-python/0001-gettext-handle-unsupported-languages-properly.patch b/recipes-security/selinux/selinux-python/0001-gettext-handle-unsupported-languages-properly.patch
deleted file mode 100644
index b83300d..0000000
--- a/recipes-security/selinux/selinux-python/0001-gettext-handle-unsupported-languages-properly.patch
+++ /dev/null
@@ -1,173 +0,0 @@
-From 4693794ff8c52f87a4abdb68fe9dae6618023c03 Mon Sep 17 00:00:00 2001
-From: Vit Mojzis <vmojzis@redhat.com>
-Date: Fri, 24 Jun 2022 16:24:25 +0200
-Subject: [PATCH] gettext: handle unsupported languages properly
-
-With "fallback=True" gettext.translation behaves the same as
-gettext.install and uses NullTranslations in case the
-translation file for given language was not found (as opposed to
-throwing an exception).
-
-Fixes:
-  # LANG is set to any "unsupported" language, e.g. en_US.UTF-8
-  $ chcat --help
-  Traceback (most recent call last):
-  File "/usr/bin/chcat", line 39, in <module>
-    t = gettext.translation(PROGNAME,
-  File "/usr/lib64/python3.9/gettext.py", line 592, in translation
-    raise FileNotFoundError(ENOENT,
-  FileNotFoundError: [Errno 2] No translation file found for domain: 'selinux-python'
-
-Signed-off-by: Vit Mojzis <vmojzis@redhat.com>
-Reviewed-by: Daniel Burgener <dburgener@linux.microsoft.com>
-Acked-by: Petr Lautrbach <plautrba@redhat.com>
-
-Upstream-Status: Backport
-[https://github.com/SELinuxProject/selinux/commit/344463076b2a91e1d2c7f5cc3835dc1a53a05e88]
-
-Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
----
- chcat/chcat                           | 5 +++--
- semanage/semanage                     | 3 ++-
- semanage/seobject.py                  | 3 ++-
- sepolgen/src/sepolgen/sepolgeni18n.py | 4 +++-
- sepolicy/sepolicy.py                  | 3 ++-
- sepolicy/sepolicy/__init__.py         | 3 ++-
- sepolicy/sepolicy/generate.py         | 3 ++-
- sepolicy/sepolicy/gui.py              | 3 ++-
- sepolicy/sepolicy/interface.py        | 3 ++-
- 9 files changed, 20 insertions(+), 10 deletions(-)
-
-diff --git a/chcat/chcat b/chcat/chcat
-index e779fcc..952cb81 100755
---- a/chcat/chcat
-+++ b/chcat/chcat
-@@ -38,9 +38,10 @@ try:
-         kwargs['unicode'] = True
-     t = gettext.translation(PROGNAME,
-                     localedir="/usr/share/locale",
--                    **kwargs)
-+                    **kwargs,
-+                    fallback=True)
-     _ = t.gettext
--except ImportError:
-+except:
-     try:
-         import builtins
-         builtins.__dict__['_'] = str
-diff --git a/semanage/semanage b/semanage/semanage
-index 8f4e44a..f45061a 100644
---- a/semanage/semanage
-+++ b/semanage/semanage
-@@ -38,7 +38,8 @@ try:
-         kwargs['unicode'] = True
-     t = gettext.translation(PROGNAME,
-                     localedir="/usr/share/locale",
--                    **kwargs)
-+                    **kwargs,
-+                    fallback=True)
-     _ = t.gettext
- except:
-     try:
-diff --git a/semanage/seobject.py b/semanage/seobject.py
-index ff8f4e9..0782c08 100644
---- a/semanage/seobject.py
-+++ b/semanage/seobject.py
-@@ -42,7 +42,8 @@ try:
-         kwargs['unicode'] = True
-     t = gettext.translation(PROGNAME,
-                     localedir="/usr/share/locale",
--                    **kwargs)
-+                    **kwargs,
-+                    fallback=True)
-     _ = t.gettext
- except:
-     try:
-diff --git a/sepolgen/src/sepolgen/sepolgeni18n.py b/sepolgen/src/sepolgen/sepolgeni18n.py
-index 56ebd80..1ff307d 100644
---- a/sepolgen/src/sepolgen/sepolgeni18n.py
-+++ b/sepolgen/src/sepolgen/sepolgeni18n.py
-@@ -19,7 +19,9 @@
- 
- try: 
-     import gettext
--    t = gettext.translation( 'selinux-python' )
-+    t = gettext.translation("selinux-python",
-+                        localedir="/usr/share/locale",
-+                        fallback=True)
-     _ = t.gettext
- except:
-     def _(str):
-diff --git a/sepolicy/sepolicy.py b/sepolicy/sepolicy.py
-index 7ebe0ef..c7a70e0 100755
---- a/sepolicy/sepolicy.py
-+++ b/sepolicy/sepolicy.py
-@@ -36,7 +36,8 @@ try:
-         kwargs['unicode'] = True
-     t = gettext.translation(PROGNAME,
-                     localedir="/usr/share/locale",
--                    **kwargs)
-+                    **kwargs,
-+                    fallback=True)
-     _ = t.gettext
- except:
-     try:
-diff --git a/sepolicy/sepolicy/__init__.py b/sepolicy/sepolicy/__init__.py
-index 7208234..9c3caa0 100644
---- a/sepolicy/sepolicy/__init__.py
-+++ b/sepolicy/sepolicy/__init__.py
-@@ -31,7 +31,8 @@ try:
-         kwargs['unicode'] = True
-     t = gettext.translation(PROGNAME,
-                     localedir="/usr/share/locale",
--                    **kwargs)
-+                    **kwargs,
-+                    fallback=True)
-     _ = t.gettext
- except:
-     try:
-diff --git a/sepolicy/sepolicy/generate.py b/sepolicy/sepolicy/generate.py
-index 67189fc..3717d5d 100644
---- a/sepolicy/sepolicy/generate.py
-+++ b/sepolicy/sepolicy/generate.py
-@@ -56,7 +56,8 @@ try:
-         kwargs['unicode'] = True
-     t = gettext.translation(PROGNAME,
-                     localedir="/usr/share/locale",
--                    **kwargs)
-+                    **kwargs,
-+                    fallback=True)
-     _ = t.gettext
- except:
-     try:
-diff --git a/sepolicy/sepolicy/gui.py b/sepolicy/sepolicy/gui.py
-index b026374..5bdbfeb 100644
---- a/sepolicy/sepolicy/gui.py
-+++ b/sepolicy/sepolicy/gui.py
-@@ -49,7 +49,8 @@ try:
-         kwargs['unicode'] = True
-     t = gettext.translation(PROGNAME,
-                     localedir="/usr/share/locale",
--                    **kwargs)
-+                    **kwargs,
-+                    fallback=True)
-     _ = t.gettext
- except:
-     try:
-diff --git a/sepolicy/sepolicy/interface.py b/sepolicy/sepolicy/interface.py
-index 599f97f..43f8644 100644
---- a/sepolicy/sepolicy/interface.py
-+++ b/sepolicy/sepolicy/interface.py
-@@ -38,7 +38,8 @@ try:
-         kwargs['unicode'] = True
-     t = gettext.translation(PROGNAME,
-                     localedir="/usr/share/locale",
--                    **kwargs)
-+                    **kwargs,
-+                    fallback=True)
-     _ = t.gettext
- except:
-     try:
--- 
-2.25.1
-
diff --git a/recipes-security/selinux/selinux-python/fix-sepolicy-install-path.patch b/recipes-security/selinux/selinux-python/fix-sepolicy-install-path.patch
index bd14450..5eb2e54 100644
--- a/recipes-security/selinux/selinux-python/fix-sepolicy-install-path.patch
+++ b/recipes-security/selinux/selinux-python/fix-sepolicy-install-path.patch
@@ -1,4 +1,4 @@
-From d43220e336edf8ccaaa7bd3eb9c13874ed34d468 Mon Sep 17 00:00:00 2001
+From 2a0c2489e9d245502e7a9dc5878da01f9d64db2a Mon Sep 17 00:00:00 2001
 From: Xin Ouyang <Xin.Ouyang@windriver.com>
 Date: Mon, 23 Sep 2013 21:17:59 +0800
 Subject: [PATCH] sepolicy: fix install path for new pymodule sepolicy
@@ -13,15 +13,15 @@ Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
  1 file changed, 1 insertion(+), 1 deletion(-)
 
 diff --git a/sepolicy/Makefile b/sepolicy/Makefile
-index 3361be4..5842321 100644
+index 4e9e93d..512aab5 100644
 --- a/sepolicy/Makefile
 +++ b/sepolicy/Makefile
 @@ -27,7 +27,7 @@ test:
  	@$(PYTHON) test_sepolicy.py -v
  
  install:
--	$(PYTHON) setup.py install --prefix=$(PREFIX) `test -n "$(DESTDIR)" && echo --root $(DESTDIR)` $(PYTHON_SETUP_ARGS)
-+	$(PYTHON) setup.py install --prefix=$(PREFIX) --root=$(DESTDIR) --install-lib=$(PYTHONLIBDIR) --no-compile $(PYTHON_SETUP_ARGS)
+-	$(PYTHON) -m pip install --prefix=$(PREFIX) `test -n "$(DESTDIR)" && echo --root $(DESTDIR) --ignore-installed --no-deps` $(PYTHON_SETUP_ARGS) .
++	$(PYTHON) -m pip install --prefix=$(PREFIX) --root $(DESTDIR) --ignore-installed --no-deps $(PYTHON_SETUP_ARGS) .
  	[ -d $(DESTDIR)$(BINDIR) ] || mkdir -p $(DESTDIR)$(BINDIR)
  	install -m 755 sepolicy.py $(DESTDIR)$(BINDIR)/sepolicy
  	(cd $(DESTDIR)$(BINDIR); ln -sf sepolicy sepolgen)
diff --git a/recipes-security/selinux/selinux-python_3.4.bb b/recipes-security/selinux/selinux-python_3.5.bb
similarity index 79%
rename from recipes-security/selinux/selinux-python_3.4.bb
rename to recipes-security/selinux/selinux-python_3.5.bb
index cc279f2..9ff63db 100644
--- a/recipes-security/selinux/selinux-python_3.4.bb
+++ b/recipes-security/selinux/selinux-python_3.5.bb
@@ -4,19 +4,18 @@ This package contains Python modules sepolgen, sepolicy; And the \
 SELinux utilities audit2allow, chcat, semanage ..."
 SECTION = "base"
 LICENSE = "GPL-2.0-or-later"
-LIC_FILES_CHKSUM = "file://${S}/COPYING;md5=393a5ca445f6965873eca0259a17f833"
+LIC_FILES_CHKSUM = "file://${S}/LICENSE;md5=393a5ca445f6965873eca0259a17f833"
 
 require selinux_common.inc
 
-inherit python3native
+inherit python3targetconfig
 
 SRC_URI += "file://fix-sepolicy-install-path.patch \
-            file://0001-gettext-handle-unsupported-languages-properly.patch \
            "
 
 S = "${WORKDIR}/git/python"
 
-DEPENDS = "libsepol libselinux gettext-native"
+DEPENDS = "libsepol libselinux gettext-native python3-setuptools-scm-native"
 
 RDEPENDS:${PN} = "\
         python3-core \
@@ -96,19 +95,26 @@ FILES:${PN}-sepolgen-ifgen = "\
         ${bindir}/sepolgen-ifgen-attr-helper \
 "
 FILES:${PN}-sepolgen = "\
-        ${libdir}/python${PYTHON_BASEVERSION}/site-packages/sepolgen* \
+        ${PYTHON_SITEPACKAGES_DIR}/sepolgen* \
         ${localstatedir}/lib/sepolgen/perm_map \
 "
 
 FILES:${PN} += "\
-        ${libdir}/python${PYTHON_BASEVERSION}/site-packages/seobject.py* \
-        ${libdir}/python${PYTHON_BASEVERSION}/site-packages/sepolicy*.egg-info \
-        ${libdir}/python${PYTHON_BASEVERSION}/site-packages/sepolicy/* \
+        ${PYTHON_SITEPACKAGES_DIR}/seobject.py* \
+        ${PYTHON_SITEPACKAGES_DIR}/sepolicy*.dist-info \
+        ${PYTHON_SITEPACKAGES_DIR}/sepolicy/* \
 "
 
 do_install() {
     oe_runmake DESTDIR="${D}" \
         PYLIBVER='python${PYTHON_BASEVERSION}' \
-        PYTHONLIBDIR='${libdir}/python${PYTHON_BASEVERSION}/site-packages' \
+        PYTHONLIBDIR='${PYTHON_SITEPACKAGES_DIR}' \
         install
+
+    # Remove .pyc files
+    find ${D} -name *.pyc -delete
+
+    # Fix buildpaths issue
+    sed -i -e 's,${WORKDIR},,g' \
+        ${D}${PYTHON_SITEPACKAGES_DIR}/sepolicy-${PV}.dist-info/direct_url.json
 }
-- 
2.25.1



^ permalink raw reply related	[flat|nested] 17+ messages in thread
* [meta-selinux][PATCH 14/17] selinux-dbus: upgrade 3.4 -> 3.5
  2023-03-11 13:12 [meta-selinux][PATCH 01/17] gitignore: add it Yi Zhao
                   ` (11 preceding siblings ...)
  2023-03-11 13:13 ` [meta-selinux][PATCH 13/17] selinux-python: " Yi Zhao
@ 2023-03-11 13:13 ` Yi Zhao
  2023-03-11 13:13 ` [meta-selinux][PATCH 15/17] selinux-gui: " Yi Zhao
                   ` (2 subsequent siblings)
  15 siblings, 0 replies; 17+ messages in thread
From: Yi Zhao @ 2023-03-11 13:13 UTC (permalink / raw)
  To: yocto, joe.macdonald, joe, joe_macdonald

License-Update: Rename COPYING to LICENSE. No content changes.

Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
---
 .../selinux/{selinux-dbus_3.4.bb => selinux-dbus_3.5.bb}        | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
 rename recipes-security/selinux/{selinux-dbus_3.4.bb => selinux-dbus_3.5.bb} (88%)

diff --git a/recipes-security/selinux/selinux-dbus_3.4.bb b/recipes-security/selinux/selinux-dbus_3.5.bb
similarity index 88%
rename from recipes-security/selinux/selinux-dbus_3.4.bb
rename to recipes-security/selinux/selinux-dbus_3.5.bb
index 1619829..b1198af 100644
--- a/recipes-security/selinux/selinux-dbus_3.4.bb
+++ b/recipes-security/selinux/selinux-dbus_3.5.bb
@@ -3,7 +3,7 @@ DESCRIPTION = "\
 Provide SELinux dbus service files and scripts."
 SECTION = "base"
 LICENSE = "GPL-2.0-or-later"
-LIC_FILES_CHKSUM = "file://${S}/COPYING;md5=393a5ca445f6965873eca0259a17f833"
+LIC_FILES_CHKSUM = "file://${S}/LICENSE;md5=393a5ca445f6965873eca0259a17f833"
 
 require selinux_common.inc
 
-- 
2.25.1



^ permalink raw reply related	[flat|nested] 17+ messages in thread
* [meta-selinux][PATCH 15/17] selinux-gui: upgrade 3.4 -> 3.5
  2023-03-11 13:12 [meta-selinux][PATCH 01/17] gitignore: add it Yi Zhao
                   ` (12 preceding siblings ...)
  2023-03-11 13:13 ` [meta-selinux][PATCH 14/17] selinux-dbus: " Yi Zhao
@ 2023-03-11 13:13 ` Yi Zhao
  2023-03-11 13:13 ` [meta-selinux][PATCH 16/17] selinux-sandbox: " Yi Zhao
  2023-03-11 13:13 ` [meta-selinux][PATCH 17/17] semodule-utils: " Yi Zhao
  15 siblings, 0 replies; 17+ messages in thread
From: Yi Zhao @ 2023-03-11 13:13 UTC (permalink / raw)
  To: yocto, joe.macdonald, joe, joe_macdonald

License-Update: Rename COPYING to LICENSE. No content changes.

* Drop backport patch.

Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
---
 ...andle-unsupported-languages-properly.patch | 199 ------------------
 ...{selinux-gui_3.4.bb => selinux-gui_3.5.bb} |   4 +-
 2 files changed, 1 insertion(+), 202 deletions(-)
 delete mode 100644 recipes-security/selinux/selinux-gui/0001-gettext-handle-unsupported-languages-properly.patch
 rename recipes-security/selinux/{selinux-gui_3.4.bb => selinux-gui_3.5.bb} (77%)

diff --git a/recipes-security/selinux/selinux-gui/0001-gettext-handle-unsupported-languages-properly.patch b/recipes-security/selinux/selinux-gui/0001-gettext-handle-unsupported-languages-properly.patch
deleted file mode 100644
index d79db22..0000000
--- a/recipes-security/selinux/selinux-gui/0001-gettext-handle-unsupported-languages-properly.patch
+++ /dev/null
@@ -1,199 +0,0 @@
-From a0a67119412622141a7f8365eff10de6395be7ca Mon Sep 17 00:00:00 2001
-From: Vit Mojzis <vmojzis@redhat.com>
-Date: Fri, 24 Jun 2022 16:24:25 +0200
-Subject: [PATCH] gettext: handle unsupported languages properly
-
-With "fallback=True" gettext.translation behaves the same as
-gettext.install and uses NullTranslations in case the
-translation file for given language was not found (as opposed to
-throwing an exception).
-
-Fixes:
-  # LANG is set to any "unsupported" language, e.g. en_US.UTF-8
-  $ chcat --help
-  Traceback (most recent call last):
-  File "/usr/bin/chcat", line 39, in <module>
-    t = gettext.translation(PROGNAME,
-  File "/usr/lib64/python3.9/gettext.py", line 592, in translation
-    raise FileNotFoundError(ENOENT,
-  FileNotFoundError: [Errno 2] No translation file found for domain: 'selinux-python'
-
-Signed-off-by: Vit Mojzis <vmojzis@redhat.com>
-Reviewed-by: Daniel Burgener <dburgener@linux.microsoft.com>
-Acked-by: Petr Lautrbach <plautrba@redhat.com>
-
-Upstream-Status: Backport
-[https://github.com/SELinuxProject/selinux/commit/344463076b2a91e1d2c7f5cc3835dc1a53a05e88]
-
-Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
----
- booleansPage.py          | 3 ++-
- domainsPage.py           | 3 ++-
- fcontextPage.py          | 3 ++-
- loginsPage.py            | 3 ++-
- modulesPage.py           | 3 ++-
- polgengui.py             | 3 ++-
- portsPage.py             | 3 ++-
- semanagePage.py          | 3 ++-
- statusPage.py            | 3 ++-
- system-config-selinux.py | 3 ++-
- usersPage.py             | 3 ++-
- 11 files changed, 22 insertions(+), 11 deletions(-)
-
-diff --git a/booleansPage.py b/booleansPage.py
-index 5beec58..ad11a9b 100644
---- a/booleansPage.py
-+++ b/booleansPage.py
-@@ -46,7 +46,8 @@ try:
-         kwargs['unicode'] = True
-     t = gettext.translation(PROGNAME,
-                     localedir="/usr/share/locale",
--                    **kwargs)
-+                    **kwargs,
-+                    fallback=True)
-     _ = t.gettext
- except:
-     try:
-diff --git a/domainsPage.py b/domainsPage.py
-index e08f34b..e6eadd6 100644
---- a/domainsPage.py
-+++ b/domainsPage.py
-@@ -38,7 +38,8 @@ try:
-         kwargs['unicode'] = True
-     t = gettext.translation(PROGNAME,
-                     localedir="/usr/share/locale",
--                    **kwargs)
-+                    **kwargs,
-+                    fallback=True)
-     _ = t.gettext
- except:
-     try:
-diff --git a/fcontextPage.py b/fcontextPage.py
-index bac2bec..767664f 100644
---- a/fcontextPage.py
-+++ b/fcontextPage.py
-@@ -55,7 +55,8 @@ try:
-         kwargs['unicode'] = True
-     t = gettext.translation(PROGNAME,
-                     localedir="/usr/share/locale",
--                    **kwargs)
-+                    **kwargs,
-+                    fallback=True)
-     _ = t.gettext
- except:
-     try:
-diff --git a/loginsPage.py b/loginsPage.py
-index 18b93d8..7e08232 100644
---- a/loginsPage.py
-+++ b/loginsPage.py
-@@ -37,7 +37,8 @@ try:
-         kwargs['unicode'] = True
-     t = gettext.translation(PROGNAME,
-                     localedir="/usr/share/locale",
--                    **kwargs)
-+                    **kwargs,
-+                    fallback=True)
-     _ = t.gettext
- except:
-     try:
-diff --git a/modulesPage.py b/modulesPage.py
-index c546d45..02b79f1 100644
---- a/modulesPage.py
-+++ b/modulesPage.py
-@@ -38,7 +38,8 @@ try:
-         kwargs['unicode'] = True
-     t = gettext.translation(PROGNAME,
-                     localedir="/usr/share/locale",
--                    **kwargs)
-+                    **kwargs,
-+                    fallback=True)
-     _ = t.gettext
- except:
-     try:
-diff --git a/polgengui.py b/polgengui.py
-index a18f1cb..7a3ecd5 100644
---- a/polgengui.py
-+++ b/polgengui.py
-@@ -71,7 +71,8 @@ try:
-         kwargs['unicode'] = True
-     t = gettext.translation(PROGNAME,
-                     localedir="/usr/share/locale",
--                    **kwargs)
-+                    **kwargs,
-+                    fallback=True)
-     _ = t.gettext
- except:
-     try:
-diff --git a/portsPage.py b/portsPage.py
-index 54aa80d..bee2bdf 100644
---- a/portsPage.py
-+++ b/portsPage.py
-@@ -43,7 +43,8 @@ try:
-         kwargs['unicode'] = True
-     t = gettext.translation(PROGNAME,
-                     localedir="/usr/share/locale",
--                    **kwargs)
-+                    **kwargs,
-+                    fallback=True)
-     _ = t.gettext
- except:
-     try:
-diff --git a/semanagePage.py b/semanagePage.py
-index 1371d4e..efad14d 100644
---- a/semanagePage.py
-+++ b/semanagePage.py
-@@ -30,7 +30,8 @@ try:
-         kwargs['unicode'] = True
-     t = gettext.translation(PROGNAME,
-                     localedir="/usr/share/locale",
--                    **kwargs)
-+                    **kwargs,
-+                    fallback=True)
-     _ = t.gettext
- except:
-     try:
-diff --git a/statusPage.py b/statusPage.py
-index c241ef8..832849e 100644
---- a/statusPage.py
-+++ b/statusPage.py
-@@ -43,7 +43,8 @@ try:
-         kwargs['unicode'] = True
-     t = gettext.translation(PROGNAME,
-                     localedir="/usr/share/locale",
--                    **kwargs)
-+                    **kwargs,
-+                    fallback=True)
-     _ = t.gettext
- except:
-     try:
-diff --git a/system-config-selinux.py b/system-config-selinux.py
-index 1b460c9..9f53b7f 100644
---- a/system-config-selinux.py
-+++ b/system-config-selinux.py
-@@ -53,7 +53,8 @@ try:
-         kwargs['unicode'] = True
-     t = gettext.translation(PROGNAME,
-                     localedir="/usr/share/locale",
--                    **kwargs)
-+                    **kwargs,
-+                    fallback=True)
-     _ = t.gettext
- except:
-     try:
-diff --git a/usersPage.py b/usersPage.py
-index d51bd96..9acd3b8 100644
---- a/usersPage.py
-+++ b/usersPage.py
-@@ -37,7 +37,8 @@ try:
-         kwargs['unicode'] = True
-     t = gettext.translation(PROGNAME,
-                     localedir="/usr/share/locale",
--                    **kwargs)
-+                    **kwargs,
-+                    fallback=True)
-     _ = t.gettext
- except:
-     try:
--- 
-2.25.1
-
diff --git a/recipes-security/selinux/selinux-gui_3.4.bb b/recipes-security/selinux/selinux-gui_3.5.bb
similarity index 77%
rename from recipes-security/selinux/selinux-gui_3.4.bb
rename to recipes-security/selinux/selinux-gui_3.5.bb
index fa80860..fbd5e70 100644
--- a/recipes-security/selinux/selinux-gui_3.4.bb
+++ b/recipes-security/selinux/selinux-gui_3.5.bb
@@ -4,12 +4,10 @@ Provide SELinux Management tool (system-config-selinux) and SELinux \
 Policy Generation Tool (selinux-polgengui)"
 SECTION = "base"
 LICENSE = "GPL-2.0-or-later"
-LIC_FILES_CHKSUM = "file://${S}/COPYING;md5=393a5ca445f6965873eca0259a17f833"
+LIC_FILES_CHKSUM = "file://${S}/LICENSE;md5=393a5ca445f6965873eca0259a17f833"
 
 require selinux_common.inc
 
-SRC_URI += "file://0001-gettext-handle-unsupported-languages-properly.patch"
-
 S = "${WORKDIR}/git/gui"
 
 DEPENDS = "gettext-native"
-- 
2.25.1



^ permalink raw reply related	[flat|nested] 17+ messages in thread
* [meta-selinux][PATCH 16/17] selinux-sandbox: upgrade 3.4 -> 3.5
  2023-03-11 13:12 [meta-selinux][PATCH 01/17] gitignore: add it Yi Zhao
                   ` (13 preceding siblings ...)
  2023-03-11 13:13 ` [meta-selinux][PATCH 15/17] selinux-gui: " Yi Zhao
@ 2023-03-11 13:13 ` Yi Zhao
  2023-03-11 13:13 ` [meta-selinux][PATCH 17/17] semodule-utils: " Yi Zhao
  15 siblings, 0 replies; 17+ messages in thread
From: Yi Zhao @ 2023-03-11 13:13 UTC (permalink / raw)
  To: yocto, joe.macdonald, joe, joe_macdonald

License-Update: Rename COPYING to LICENSE. No content changes.

* Drop backport patch.

Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
---
 ...andle-unsupported-languages-properly.patch | 49 -------------------
 ...-sandbox_3.4.bb => selinux-sandbox_3.5.bb} |  3 +-
 2 files changed, 1 insertion(+), 51 deletions(-)
 delete mode 100644 recipes-security/selinux/selinux-sandbox/0001-gettext-handle-unsupported-languages-properly.patch
 rename recipes-security/selinux/{selinux-sandbox_3.4.bb => selinux-sandbox_3.5.bb} (84%)

diff --git a/recipes-security/selinux/selinux-sandbox/0001-gettext-handle-unsupported-languages-properly.patch b/recipes-security/selinux/selinux-sandbox/0001-gettext-handle-unsupported-languages-properly.patch
deleted file mode 100644
index f1d8235..0000000
--- a/recipes-security/selinux/selinux-sandbox/0001-gettext-handle-unsupported-languages-properly.patch
+++ /dev/null
@@ -1,49 +0,0 @@
-From 70602601ac1cfc4399430ef8609b96fc224d1e25 Mon Sep 17 00:00:00 2001
-From: Vit Mojzis <vmojzis@redhat.com>
-Date: Fri, 24 Jun 2022 16:24:25 +0200
-Subject: [PATCH] gettext: handle unsupported languages properly
-
-With "fallback=True" gettext.translation behaves the same as
-gettext.install and uses NullTranslations in case the
-translation file for given language was not found (as opposed to
-throwing an exception).
-
-Fixes:
-  # LANG is set to any "unsupported" language, e.g. en_US.UTF-8
-  $ chcat --help
-  Traceback (most recent call last):
-  File "/usr/bin/chcat", line 39, in <module>
-    t = gettext.translation(PROGNAME,
-  File "/usr/lib64/python3.9/gettext.py", line 592, in translation
-    raise FileNotFoundError(ENOENT,
-  FileNotFoundError: [Errno 2] No translation file found for domain: 'selinux-python'
-
-Signed-off-by: Vit Mojzis <vmojzis@redhat.com>
-Reviewed-by: Daniel Burgener <dburgener@linux.microsoft.com>
-Acked-by: Petr Lautrbach <plautrba@redhat.com>
-
-Upstream-Status: Backport
-[https://github.com/SELinuxProject/selinux/commit/344463076b2a91e1d2c7f5cc3835dc1a53a05e88]
-
-Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
----
- sandbox | 3 ++-
- 1 file changed, 2 insertions(+), 1 deletion(-)
-
-diff --git a/sandbox b/sandbox
-index cd5709f..789621e 100644
---- a/sandbox
-+++ b/sandbox
-@@ -45,7 +45,8 @@ try:
-         kwargs['unicode'] = True
-     t = gettext.translation(PROGNAME,
-                     localedir="/usr/share/locale",
--                    **kwargs)
-+                    **kwargs,
-+                    fallback=True)
-     _ = t.gettext
- except:
-     try:
--- 
-2.25.1
-
diff --git a/recipes-security/selinux/selinux-sandbox_3.4.bb b/recipes-security/selinux/selinux-sandbox_3.5.bb
similarity index 84%
rename from recipes-security/selinux/selinux-sandbox_3.4.bb
rename to recipes-security/selinux/selinux-sandbox_3.5.bb
index a5a8e13..2cb55d6 100644
--- a/recipes-security/selinux/selinux-sandbox_3.4.bb
+++ b/recipes-security/selinux/selinux-sandbox_3.5.bb
@@ -5,12 +5,11 @@ sandbox domain only allows applications the ability to read and write \
 stdin, stdout and any other file descriptors handed to it."
 SECTION = "base"
 LICENSE = "GPL-2.0-or-later"
-LIC_FILES_CHKSUM = "file://${S}/COPYING;md5=393a5ca445f6965873eca0259a17f833"
+LIC_FILES_CHKSUM = "file://${S}/LICENSE;md5=393a5ca445f6965873eca0259a17f833"
 
 require selinux_common.inc
 
 SRC_URI += "file://sandbox-de-bashify.patch \
-            file://0001-gettext-handle-unsupported-languages-properly.patch \
            "
 
 S = "${WORKDIR}/git/sandbox"
-- 
2.25.1



^ permalink raw reply related	[flat|nested] 17+ messages in thread
* [meta-selinux][PATCH 17/17] semodule-utils: upgrade 3.4 -> 3.5
  2023-03-11 13:12 [meta-selinux][PATCH 01/17] gitignore: add it Yi Zhao
                   ` (14 preceding siblings ...)
  2023-03-11 13:13 ` [meta-selinux][PATCH 16/17] selinux-sandbox: " Yi Zhao
@ 2023-03-11 13:13 ` Yi Zhao
  15 siblings, 0 replies; 17+ messages in thread
From: Yi Zhao @ 2023-03-11 13:13 UTC (permalink / raw)
  To: yocto, joe.macdonald, joe, joe_macdonald

License-Update: Rename COPYING to LICENSE. No content changes.

Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
---
 .../selinux/{semodule-utils_3.4.bb => semodule-utils_3.5.bb}    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
 rename recipes-security/selinux/{semodule-utils_3.4.bb => semodule-utils_3.5.bb} (91%)

diff --git a/recipes-security/selinux/semodule-utils_3.4.bb b/recipes-security/selinux/semodule-utils_3.5.bb
similarity index 91%
rename from recipes-security/selinux/semodule-utils_3.4.bb
rename to recipes-security/selinux/semodule-utils_3.5.bb
index 3f53cf0..0c1c189 100644
--- a/recipes-security/selinux/semodule-utils_3.4.bb
+++ b/recipes-security/selinux/semodule-utils_3.5.bb
@@ -4,7 +4,7 @@ The utilities to create, expand, link and show the dependencies between \
 the SELinux policy module packages."
 SECTION = "base"
 LICENSE = "GPL-2.0-or-later"
-LIC_FILES_CHKSUM = "file://${S}/COPYING;md5=393a5ca445f6965873eca0259a17f833"
+LIC_FILES_CHKSUM = "file://${S}/LICENSE;md5=393a5ca445f6965873eca0259a17f833"
 
 require selinux_common.inc
 
-- 
2.25.1



^ permalink raw reply related	[flat|nested] 17+ messages in thread
end of thread, other threads:[~2023-03-11 13:14 UTC | newest]

Thread overview: 17+ messages (download: mbox.gz / follow: Atom feed)
-- links below jump to the message on this page --
2023-03-11 13:12 [meta-selinux][PATCH 01/17] gitignore: add it Yi Zhao
2023-03-11 13:12 ` [meta-selinux][PATCH 02/17] refpolicy: update to latest git rev Yi Zhao
2023-03-11 13:12 ` [meta-selinux][PATCH 03/17] selinux: upgrade 3.4 -> 3.5 Yi Zhao
2023-03-11 13:12 ` [meta-selinux][PATCH 04/17] libsepol: " Yi Zhao
2023-03-11 13:12 ` [meta-selinux][PATCH 05/17] libselinux: " Yi Zhao
2023-03-11 13:12 ` [meta-selinux][PATCH 06/17] libselinux-python: " Yi Zhao
2023-03-11 13:12 ` [meta-selinux][PATCH 07/17] libsemanage: " Yi Zhao
2023-03-11 13:12 ` [meta-selinux][PATCH 08/17] checkpolicy: " Yi Zhao
2023-03-11 13:13 ` [meta-selinux][PATCH 09/17] secilc: " Yi Zhao
2023-03-11 13:13 ` [meta-selinux][PATCH 10/17] policycoreutils: " Yi Zhao
2023-03-11 13:13 ` [meta-selinux][PATCH 11/17] mcstrans: " Yi Zhao
2023-03-11 13:13 ` [meta-selinux][PATCH 12/17] restorecond: " Yi Zhao
2023-03-11 13:13 ` [meta-selinux][PATCH 13/17] selinux-python: " Yi Zhao
2023-03-11 13:13 ` [meta-selinux][PATCH 14/17] selinux-dbus: " Yi Zhao
2023-03-11 13:13 ` [meta-selinux][PATCH 15/17] selinux-gui: " Yi Zhao
2023-03-11 13:13 ` [meta-selinux][PATCH 16/17] selinux-sandbox: " Yi Zhao
2023-03-11 13:13 ` [meta-selinux][PATCH 17/17] semodule-utils: " Yi Zhao

